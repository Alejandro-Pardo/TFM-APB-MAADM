{
  "method_name": "put_policy",
  "url": "https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/fms/client/put_policy.html",
  "description": "Creates an Firewall Manager policy. A Firewall Manager policy is specific to the individual policy type. If you want to enforce multiple policy types across accounts, you can create multiple policies. You can create more than one policy for each type. If you add a new account to an organization that you created with Organizations, Firewall Manager automatically applies the policy to the resources in that account that are within scope of the policy. Firewall Manager provides the following types of policies:",
  "parameters": [
    {
      "name": "Policy",
      "type": "dict",
      "required": true,
      "description": "The details of the Firewall Manager policy to be created. PolicyId (string) --- The ID of the Firewall Manager policy. The name of the Firewall Manager policy. PolicyUpdateToken (string) --- A unique identifier for each update to the policy. When issuing a PutPolicy request, the PolicyUpdateToken in the request must match the PolicyUpdateToken of the current policy version. To get the PolicyUpdateToken of the current policy version, use a GetPolicy request. Details about the security service that is being used to protect the resources. The service that the policy is using to protect the resources. This specifies the type of policy that is created, either an WAF policy, a Shield Advanced policy, or a security group policy. For security group policies, Firewall Manager supports one security group for each common policy and for each content audit policy. This is an adjustable limit that you can increase by contacting Amazon Web Services Support. ManagedServiceData (string) --- Details about the service that are specific to the service type, in JSON format. Example: DNS_FIREWALL \"{\\\"type\\\":\\\"DNS_FIREWALL\\\",\\\"preProcessRuleGroups\\\":[{\\\"ruleGroupId\\\":\\\"rslvr-frg-1\\\",\\\"priority\\\":10}],\\\"postProcessRuleGroups\\\":[{\\\"ruleGroupId\\\":\\\"rslvr-frg-2\\\",\\\"priority\\\":9911}]}\" Example: IMPORT_NETWORK_FIREWALL \"{\\\"type\\\":\\\"IMPORT_NETWORK_FIREWALL\\\",\\\"awsNetworkFirewallConfig\\\":{\\\"networkFirewallStatelessRuleGroupReferences\\\":[{\\\"resourceARN\\\":\\\"arn:aws:network-firewall:us-west-2:000000000000:stateless-rulegroup\\/rg1\\\",\\\"priority\\\":1}],\\\"networkFirewallStatelessDefaultActions\\\":[\\\"aws:drop\\\"],\\\"networkFirewallStatelessFragmentDefaultActions\\\":[\\\"aws:pass\\\"],\\\"networkFirewallStatelessCustomActions\\\":[],\\\"networkFirewallStatefulRuleGroupReferences\\\":[{\\\"resourceARN\\\":\\\"arn:aws:network-firewall:us-west-2:aws-managed:stateful-rulegroup\\/ThreatSignaturesEmergingEventsStrictOrder\\\",\\\"priority\\\":8}],\\\"networkFirewallStatefulEngineOptions\\\":{\\\"ruleOrder\\\":\\\"STRICT_ORDER\\\"},\\\"networkFirewallStatefulDefaultActions\\\":[\\\"aws:drop_strict\\\"]}}\" \"{\\\"type\\\":\\\"DNS_FIREWALL\\\",\\\"preProcessRuleGroups\\\":[{\\\"ruleGroupId\\\":\\\"rslvr-frg-1\\\",\\\"priority\\\":10}],\\\"postProcessRuleGroups\\\":[{\\\"ruleGroupId\\\":\\\"rslvr-frg-2\\\",\\\"priority\\\":9911}]}\" Example: NETWORK_FIREWALL - Centralized deployment model \"{\\\"type\\\":\\\"NETWORK_FIREWALL\\\",\\\"awsNetworkFirewallConfig\\\":{\\\"networkFirewallStatelessRuleGroupReferences\\\":[{\\\"resourceARN\\\":\\\"arn:aws:network-firewall:us-east-1:123456789011:stateless-rulegroup/test\\\",\\\"priority\\\":1}],\\\"networkFirewallStatelessDefaultActions\\\":[\\\"aws:forward_to_sfe\\\",\\\"customActionName\\\"],\\\"networkFirewallStatelessFragmentDefaultActions\\\":[\\\"aws:forward_to_sfe\\\",\\\"customActionName\\\"],\\\"networkFirewallStatelessCustomActions\\\":[{\\\"actionName\\\":\\\"customActionName\\\",\\\"actionDefinition\\\":{\\\"publishMetricAction\\\":{\\\"dimensions\\\":[{\\\"value\\\":\\\"metricdimensionvalue\\\"}]}}}],\\\"networkFirewallStatefulRuleGroupReferences\\\":[{\\\"resourceARN\\\":\\\"arn:aws:network-firewall:us-east-1:123456789011:stateful-rulegroup/test\\\"}],\\\"networkFirewallLoggingConfiguration\\\":{\\\"logDestinationConfigs\\\":[{\\\"logDestinationType\\\":\\\"S3\\\",\\\"logType\\\":\\\"ALERT\\\",\\\"logDestination\\\":{\\\"bucketName\\\":\\\"s3-bucket-name\\\"}},{\\\"logDestinationType\\\":\\\"S3\\\",\\\"logType\\\":\\\"FLOW\\\",\\\"logDestination\\\":{\\\"bucketName\\\":\\\"s3-bucket-name\\\"}}],\\\"overrideExistingConfig\\\":true}},\\\"firewallDeploymentModel\\\":{\\\"centralizedFirewallDeploymentModel\\\":{\\\"centralizedFirewallOrchestrationConfig\\\":{\\\"inspectionVpcIds\\\":[{\\\"resourceId\\\":\\\"vpc-1234\\\",\\\"accountId\\\":\\\"123456789011\\\"}],\\\"firewallCreationConfig\\\":{\\\"endpointLocation\\\":{\\\"availabilityZoneConfigList\\\":[{\\\"availabilityZoneId\\\":null,\\\"availabilityZoneName\\\":\\\"us-east-1a\\\",\\\"allowedIPV4CidrList\\\":[\\\"10.0.0.0/28\\\"]}]}},\\\"allowedIPV4CidrList\\\":[]}}}}\" To use the centralized deployment model, you must set PolicyOption to CENTRALIZED. Example: NETWORK_FIREWALL - Distributed deployment model with automatic Availability Zone configuration \"{\\\"type\\\":\\\"NETWORK_FIREWALL\\\",\\\"networkFirewallStatelessRuleGroupReferences\\\":[{\\\"resourceARN\\\":\\\"arn:aws:network-firewall:us-east-1:123456789011:stateless-rulegroup/test\\\",\\\"priority\\\":1}],\\\"networkFirewallStatelessDefaultActions\\\":[\\\"aws:forward_to_sfe\\\",\\\"customActionName\\\"],\\\"networkFirewallStatelessFragmentDefaultActions\\\":[\\\"aws:forward_to_sfe\\\",\\\"customActionName\\\"],\\\"networkFirewallStatelessCustomActions\\\":[{\\\"actionName\\\":\\\"customActionName\\\",\\\"actionDefinition\\\":{\\\"publishMetricAction\\\":{\\\"dimensions\\\":[{\\\"value\\\":\\\"metricdimensionvalue\\\"}]}}}],\\\"networkFirewallStatefulRuleGroupReferences\\\":[{\\\"resourceARN\\\":\\\"arn:aws:network-firewall:us-east-1:123456789011:stateful-rulegroup/test\\\"}],\\\"networkFirewallOrchestrationConfig\\\":{\\\"singleFirewallEndpointPerVPC\\\":false,\\\"allowedIPV4CidrList\\\":[\\\"10.0.0.0/28\\\",\\\"192.168.0.0/28\\\"],\\\"routeManagementAction\\\":\\\"OFF\\\"},\\\"networkFirewallLoggingConfiguration\\\":{\\\"logDestinationConfigs\\\":[{\\\"logDestinationType\\\":\\\"S3\\\",\\\"logType\\\":\\\"ALERT\\\",\\\"logDestination\\\":{\\\"bucketName\\\":\\\"s3-bucket-name\\\"}},{\\\"logDestinationType\\\":\\\"S3\\\",\\\"logType\\\":\\\"FLOW\\\",\\\"logDestination\\\":{\\\"bucketName\\\":\\\"s3-bucket-name\\\"}}],\\\"overrideExistingConfig\\\":true}}\" With automatic Availbility Zone configuration, Firewall Manager chooses which Availability Zones to create the endpoints in. To use the distributed deployment model, you must set PolicyOption to NULL. Example: NETWORK_FIREWALL - Distributed deployment model with automatic Availability Zone configuration and route management \"{\\\"type\\\":\\\"NETWORK_FIREWALL\\\",\\\"networkFirewallStatelessRuleGroupReferences\\\":[{\\\"resourceARN\\\":\\\"arn:aws:network-firewall:us-east-1:123456789011:stateless-rulegroup/test\\\",\\\"priority\\\":1}],\\\"networkFirewallStatelessDefaultActions\\\":[\\\"aws:forward_to_sfe\\\",\\\"customActionName\\\"],\\\"networkFirewallStatelessFragmentDefaultActions\\\":[\\\"aws:forward_to_sfe\\\",\\\"customActionName\\\"],\\\"networkFirewallStatelessCustomActions\\\":[{\\\"actionName\\\":\\\"customActionName\\\",\\\"actionDefinition\\\":{\\\"publishMetricAction\\\":{\\\"dimensions\\\":[{\\\"value\\\":\\\"metricdimensionvalue\\\"}]}}}],\\\"networkFirewallStatefulRuleGroupReferences\\\":[{\\\"resourceARN\\\":\\\"arn:aws:network-firewall:us-east-1:123456789011:stateful-rulegroup/test\\\"}],\\\"networkFirewallOrchestrationConfig\\\":{\\\"singleFirewallEndpointPerVPC\\\":false,\\\"allowedIPV4CidrList\\\":[\\\"10.0.0.0/28\\\",\\\"192.168.0.0/28\\\"],\\\"routeManagementAction\\\":\\\"MONITOR\\\",\\\"routeManagementTargetTypes\\\":[\\\"InternetGateway\\\"]},\\\"networkFirewallLoggingConfiguration\\\":{\\\"logDestinationConfigs\\\":[{\\\"logDestinationType\\\":\\\"S3\\\",\\\"logType\\\":\\\"ALERT\\\",\\\"logDestination\\\":{\\\"bucketName\\\":\\\"s3-bucket-name\\\"}},{\\\"logDestinationType\\\":\\\"S3\\\",\\\"logType\\\": \\\"FLOW\\\",\\\"logDestination\\\":{\\\"bucketName\\\":\\\"s3-bucket-name\\\"}}],\\\"overrideExistingConfig\\\":true}}\" To use the distributed deployment model, you must set PolicyOption to NULL. Example: NETWORK_FIREWALL - Distributed deployment model with custom Availability Zone configuration \"{\\\"type\\\":\\\"NETWORK_FIREWALL\\\",\\\"networkFirewallStatelessRuleGroupReferences\\\":[{\\\"resourceARN\\\":\\\"arn:aws:network-firewall:us-east-1:123456789011:stateless-rulegroup/test\\\",\\\"priority\\\":1}],\\\"networkFirewallStatelessDefaultActions\\\":[\\\"aws:forward_to_sfe\\\",\\\"customActionName\\\"],\\\"networkFirewallStatelessFragmentDefaultActions\\\":[\\\"aws:forward_to_sfe\\\",\\\"fragmentcustomactionname\\\"],\\\"networkFirewallStatelessCustomActions\\\":[{\\\"actionName\\\":\\\"customActionName\\\", \\\"actionDefinition\\\":{\\\"publishMetricAction\\\":{\\\"dimensions\\\":[{\\\"value\\\":\\\"metricdimensionvalue\\\"}]}}},{\\\"actionName\\\":\\\"fragmentcustomactionname\\\",\\\"actionDefinition\\\":{\\\"publishMetricAction\\\":{\\\"dimensions\\\":[{\\\"value\\\":\\\"fragmentmetricdimensionvalue\\\"}]}}}],\\\"networkFirewallStatefulRuleGroupReferences\\\":[{\\\"resourceARN\\\":\\\"arn:aws:network-firewall:us-east-1:123456789011:stateful-rulegroup/test\\\"}],\\\"networkFirewallOrchestrationConfig\\\":{\\\"firewallCreationConfig\\\":{ \\\"endpointLocation\\\":{\\\"availabilityZoneConfigList\\\":[{\\\"availabilityZoneName\\\":\\\"us-east-1a\\\",\\\"allowedIPV4CidrList\\\":[\\\"10.0.0.0/28\\\"]},{\\\"availabilityZoneName\\\":\\\"us-east-1b\\\",\\\"allowedIPV4CidrList\\\":[ \\\"10.0.0.0/28\\\"]}]} },\\\"singleFirewallEndpointPerVPC\\\":false,\\\"allowedIPV4CidrList\\\":null,\\\"routeManagementAction\\\":\\\"OFF\\\",\\\"networkFirewallLoggingConfiguration\\\":{\\\"logDestinationConfigs\\\":[{\\\"logDestinationType\\\":\\\"S3\\\",\\\"logType\\\":\\\"ALERT\\\",\\\"logDestination\\\":{\\\"bucketName\\\":\\\"s3-bucket-name\\\"}},{\\\"logDestinationType\\\":\\\"S3\\\",\\\"logType\\\":\\\"FLOW\\\",\\\"logDestination\\\":{\\\"bucketName\\\":\\\"s3-bucket-name\\\"}}],\\\"overrideExistingConfig\\\":boolean}}\" With custom Availability Zone configuration, you define which specific Availability Zones to create endpoints in by configuring firewallCreationConfig. To configure the Availability Zones in firewallCreationConfig, specify either the availabilityZoneName or availabilityZoneId parameter, not both parameters. Example: NETWORK_FIREWALL - Distributed deployment model with custom Availability Zone configuration and route management \"{\\\"type\\\":\\\"NETWORK_FIREWALL\\\",\\\"networkFirewallStatelessRuleGroupReferences\\\":[{\\\"resourceARN\\\":\\\"arn:aws:network-firewall:us-east-1:123456789011:stateless-rulegroup/test\\\",\\\"priority\\\":1}],\\\"networkFirewallStatelessDefaultActions\\\":[\\\"aws:forward_to_sfe\\\",\\\"customActionName\\\"],\\\"networkFirewallStatelessFragmentDefaultActions\\\":[\\\"aws:forward_to_sfe\\\",\\\"fragmentcustomactionname\\\"],\\\"networkFirewallStatelessCustomActions\\\":[{\\\"actionName\\\":\\\"customActionName\\\",\\\"actionDefinition\\\":{\\\"publishMetricAction\\\":{\\\"dimensions\\\":[{\\\"value\\\":\\\"metricdimensionvalue\\\"}]}}},{\\\"actionName\\\":\\\"fragmentcustomactionname\\\",\\\"actionDefinition\\\":{\\\"publishMetricAction\\\":{\\\"dimensions\\\":[{\\\"value\\\":\\\"fragmentmetricdimensionvalue\\\"}]}}}],\\\"networkFirewallStatefulRuleGroupReferences\\\":[{\\\"resourceARN\\\":\\\"arn:aws:network-firewall:us-east-1:123456789011:stateful-rulegroup/test\\\"}],\\\"networkFirewallOrchestrationConfig\\\":{\\\"firewallCreationConfig\\\":{\\\"endpointLocation\\\":{\\\"availabilityZoneConfigList\\\":[{\\\"availabilityZoneName\\\":\\\"us-east-1a\\\",\\\"allowedIPV4CidrList\\\":[\\\"10.0.0.0/28\\\"]},{\\\"availabilityZoneName\\\":\\\"us-east-1b\\\",\\\"allowedIPV4CidrList\\\":[\\\"10.0.0.0/28\\\"]}]}},\\\"singleFirewallEndpointPerVPC\\\":false,\\\"allowedIPV4CidrList\\\":null,\\\"routeManagementAction\\\":\\\"MONITOR\\\",\\\"routeManagementTargetTypes\\\":[\\\"InternetGateway\\\"],\\\"routeManagementConfig\\\":{\\\"allowCrossAZTrafficIfNoEndpoint\\\":true}},\\\"networkFirewallLoggingConfiguration\\\":{\\\"logDestinationConfigs\\\":[{\\\"logDestinationType\\\":\\\"S3\\\",\\\"logType\\\":\\\"ALERT\\\",\\\"logDestination\\\":{\\\"bucketName\\\":\\\"s3-bucket-name\\\"}},{\\\"logDestinationType\\\":\\\"S3\\\",\\\"logType\\\":\\\"FLOW\\\",\\\"logDestination\\\":{\\\"bucketName\\\":\\\"s3-bucket-name\\\"}}],\\\"overrideExistingConfig\\\":boolean}}\" To use the distributed deployment model, you must set PolicyOption to NULL. Example: SECURITY_GROUPS_COMMON \"{\\\"type\\\":\\\"SECURITY_GROUPS_COMMON\\\",\\\"securityGroups\\\":[{\\\"id\\\":\\\"sg-03b1f67d69ed00197\\\"}],\\\"revertManualSecurityGroupChanges\\\":true,\\\"exclusiveResourceSecurityGroupManagement\\\":true,\\\"applyToAllEC2InstanceENIs\\\":false,\\\"includeSharedVPC\\\":true,\\\"enableSecurityGroupReferencesDistribution\\\":true}\" Example: SECURITY_GROUPS_COMMON - Security group tag distribution \"\"{\\\"type\\\":\\\"SECURITY_GROUPS_COMMON\\\",\\\"securityGroups\\\":[{\\\"id\\\":\\\"sg-000e55995d61a06bd\\\"}],\\\"revertManualSecurityGroupChanges\\\":true,\\\"exclusiveResourceSecurityGroupManagement\\\":false,\\\"applyToAllEC2InstanceENIs\\\":false,\\\"includeSharedVPC\\\":false,\\\"enableTagDistribution\\\":true}\"\" Firewall Manager automatically distributes tags from the primary group to the security groups created by this policy. To use security group tag distribution, you must also set revertManualSecurityGroupChanges to true, otherwise Firewall Manager won't be able to create the policy. When you enable revertManualSecurityGroupChanges, Firewall Manager identifies and reports when the security groups created by this policy become non-compliant. Firewall Manager won't distribute system tags added by Amazon Web Services services into the replica security groups. System tags begin with the aws: prefix. Example: Shared VPCs. Apply the preceding policy to resources in shared VPCs as well as to those in VPCs that the account owns \"{\\\"type\\\":\\\"SECURITY_GROUPS_COMMON\\\",\\\"revertManualSecurityGroupChanges\\\":false,\\\"exclusiveResourceSecurityGroupManagement\\\":false, \\\"applyToAllEC2InstanceENIs\\\":false,\\\"includeSharedVPC\\\":true,\\\"securityGroups\\\":[{\\\"id\\\":\\\" sg-000e55995d61a06bd\\\"}]}\" Example: SECURITY_GROUPS_CONTENT_AUDIT \"{\\\"type\\\":\\\"SECURITY_GROUPS_CONTENT_AUDIT\\\",\\\"preManagedOptions\\\":[{\\\"denyProtocolAllValue\\\":true},{\\\"auditSgDirection\\\":{\\\"type\\\":\\\"ALL\\\"}}],\\\"securityGroups\\\":[{\\\"id\\\":\\\"sg-049b2393a25468971\\\"}],\\\"securityGroupAction\\\":{\\\"type\\\":\\\"ALLOW\\\"}}\" The security group action for content audit can be ALLOW or DENY. For ALLOW, all in-scope security group rules must be within the allowed range of the policy's security group rules. For DENY, all in-scope security group rules must not contain a value or a range that matches a rule value or range in the policy security group. Example: SECURITY_GROUPS_USAGE_AUDIT \"{\\\"type\\\":\\\"SECURITY_GROUPS_USAGE_AUDIT\\\",\\\"deleteUnusedSecurityGroups\\\":true,\\\"coalesceRedundantSecurityGroups\\\":true,\\\"optionalDelayForUnusedInMinutes\\\":60}\" Example: SHIELD_ADVANCED with web ACL management \"{\\\"type\\\":\\\"SHIELD_ADVANCED\\\",\\\"optimizeUnassociatedWebACL\\\":true}\" If you set optimizeUnassociatedWebACL to true, Firewall Manager creates web ACLs in accounts within the policy scope if the web ACLs will be used by at least one resource. Firewall Manager creates web ACLs in the accounts within policy scope only if the web ACLs will be used by at least one resource. If at any time an account comes into policy scope, Firewall Manager automatically creates a web ACL in the account if at least one resource will use the web ACL. Upon enablement, Firewall Manager performs a one-time cleanup of unused web ACLs in your account. The cleanup process can take several hours. If a resource leaves policy scope after Firewall Manager creates a web ACL, Firewall Manager doesn't disassociate the resource from the web ACL. If you want Firewall Manager to clean up the web ACL, you must first manually disassociate the resources from the web ACL, and then enable the manage unused web ACLs option in your policy. If you set optimizeUnassociatedWebACL to false, and Firewall Manager automatically creates an empty web ACL in each account that's within policy scope. Specification for SHIELD_ADVANCED for Amazon CloudFront distributions \"{\\\"type\\\":\\\"SHIELD_ADVANCED\\\",\\\"automaticResponseConfiguration\\\": {\\\"automaticResponseStatus\\\":\\\"ENABLED|IGNORED|DISABLED\\\", \\\"automaticResponseAction\\\":\\\"BLOCK|COUNT\\\"}, \\\"overrideCustomerWebaclClassic\\\":true|false, \\\"optimizeUnassociatedWebACL\\\":true|false}\" For example: \"{\\\"type\\\":\\\"SHIELD_ADVANCED\\\",\\\"automaticResponseConfiguration\\\": {\\\"automaticResponseStatus\\\":\\\"ENABLED\\\", \\\"automaticResponseAction\\\":\\\"COUNT\\\"}}\" The default value for automaticResponseStatus is IGNORED. The value for automaticResponseAction is only required when automaticResponseStatus is set to ENABLED. The default value for overrideCustomerWebaclClassic is false. For other resource types that you can protect with a Shield Advanced policy, this ManagedServiceData configuration is an empty string. Example: THIRD_PARTY_FIREWALL Replace THIRD_PARTY_FIREWALL_NAME with the name of the third-party firewall. \"{ \"type\":\"THIRD_PARTY_FIREWALL\", \"thirdPartyFirewall\":\"THIRD_PARTY_FIREWALL_NAME\", \"thirdPartyFirewallConfig\":{ \"thirdPartyFirewallPolicyList\":[\"global-1\"] }, \"firewallDeploymentModel\":{ \"distributedFirewallDeploymentModel\":{ \"distributedFirewallOrchestrationConfig\":{ \"firewallCreationConfig\":{ \"endpointLocation\":{ \"availabilityZoneConfigList\":[ { \"availabilityZoneName\":\"${AvailabilityZone}\" } ] } }, \"allowedIPV4CidrList\":[ ] } } } }\" Example: WAFV2 - Account takeover prevention, Bot Control managed rule groups, optimize unassociated web ACL, and rule action override \"{\\\"type\\\":\\\"WAFV2\\\",\\\"preProcessRuleGroups\\\":[{\\\"ruleGroupArn\\\":null,\\\"overrideAction\\\":{\\\"type\\\":\\\"NONE\\\"},\\\"managedRuleGroupIdentifier\\\":{\\\"versionEnabled\\\":null,\\\"version\\\":null,\\\"vendorName\\\":\\\"AWS\\\",\\\"managedRuleGroupName\\\":\\\"AWSManagedRulesATPRuleSet\\\",\\\"managedRuleGroupConfigs\\\":[{\\\"awsmanagedRulesATPRuleSet\\\":{\\\"loginPath\\\":\\\"/loginpath\\\",\\\"requestInspection\\\":{\\\"payloadType\\\":\\\"FORM_ENCODED|JSON\\\",\\\"usernameField\\\":{\\\"identifier\\\":\\\"/form/username\\\"},\\\"passwordField\\\":{\\\"identifier\\\":\\\"/form/password\\\"}}}}]},\\\"ruleGroupType\\\":\\\"ManagedRuleGroup\\\",\\\"excludeRules\\\":[],\\\"sampledRequestsEnabled\\\":true},{\\\"ruleGroupArn\\\":null,\\\"overrideAction\\\":{\\\"type\\\":\\\"NONE\\\"},\\\"managedRuleGroupIdentifier\\\":{\\\"versionEnabled\\\":null,\\\"version\\\":null,\\\"vendorName\\\":\\\"AWS\\\",\\\"managedRuleGroupName\\\":\\\"AWSManagedRulesBotControlRuleSet\\\",\\\"managedRuleGroupConfigs\\\":[{\\\"awsmanagedRulesBotControlRuleSet\\\":{\\\"inspectionLevel\\\":\\\"TARGETED|COMMON\\\"}}]},\\\"ruleGroupType\\\":\\\"ManagedRuleGroup\\\",\\\"excludeRules\\\":[],\\\"sampledRequestsEnabled\\\":true,\\\"ruleActionOverrides\\\":[{\\\"name\\\":\\\"Rule1\\\",\\\"actionToUse\\\":{\\\"allow|block|count|captcha|challenge\\\":{}}},{\\\"name\\\":\\\"Rule2\\\",\\\"actionToUse\\\":{\\\"allow|block|count|captcha|challenge\\\":{}}}]}],\\\"postProcessRuleGroups\\\":[],\\\"defaultAction\\\":{\\\"type\\\":\\\"ALLOW\\\"},\\\"customRequestHandling\\\":null,\\\"customResponse\\\":null,\\\"overrideCustomerWebACLAssociation\\\":false,\\\"loggingConfiguration\\\":null,\\\"sampledRequestsEnabledForDefaultActions\\\":true,\\\"optimizeUnassociatedWebACL\\\":true}\" Bot Control - For information about AWSManagedRulesBotControlRuleSet managed rule groups, see AWSManagedRulesBotControlRuleSet in the WAF API Reference. Fraud Control account takeover prevention (ATP) - For information about the properties available for AWSManagedRulesATPRuleSet managed rule groups, see AWSManagedRulesATPRuleSet in the WAF API Reference. Optimize unassociated web ACL - If you set optimizeUnassociatedWebACL to true, Firewall Manager creates web ACLs in accounts within the policy scope if the web ACLs will be used by at least one resource. If a resource leaves policy scope after Firewall Manager creates a web ACL, Firewall Manager disassociates the resource from the web ACL, but won't clean up the unused web ACL. Firewall Manager only cleans up unused web ACLs when you first enable management of unused web ACLs in a policy. If you set optimizeUnassociatedWebACL to false Firewall Manager doesn't manage unused web ACLs, and Firewall Manager automatically creates an empty web ACL in each account that's within policy scope. Rule action overrides - Firewall Manager supports rule action overrides only for managed rule groups. To configure a RuleActionOverrides add the Name of the rule to override, and ActionToUse, which is the new action to use for the rule. For information about using rule action override, see RuleActionOverride in the WAF API Reference. Example: WAFV2 - CAPTCHA and Challenge configs \"{\\\"type\\\":\\\"WAFV2\\\",\\\"preProcessRuleGroups\\\":[{\\\"ruleGroupArn\\\":null,\\\"overrideAction\\\":{\\\"type\\\":\\\"NONE\\\"},\\\"managedRuleGroupIdentifier\\\":{\\\"versionEnabled\\\":null,\\\"version\\\":null,\\\"vendorName\\\":\\\"AWS\\\",\\\"managedRuleGroupName\\\":\\\"AWSManagedRulesAdminProtectionRuleSet\\\"},\\\"ruleGroupType\\\":\\\"ManagedRuleGroup\\\",\\\"excludeRules\\\":[],\\\"sampledRequestsEnabled\\\":true}],\\\"postProcessRuleGroups\\\":[],\\\"defaultAction\\\":{\\\"type\\\":\\\"ALLOW\\\"},\\\"customRequestHandling\\\":null,\\\"customResponse\\\":null,\\\"overrideCustomerWebACLAssociation\\\":false,\\\"loggingConfiguration\\\":null,\\\"sampledRequestsEnabledForDefaultActions\\\":true,\\\"captchaConfig\\\":{\\\"immunityTimeProperty\\\":{\\\"immunityTime\\\":500}},\\\"challengeConfig\\\":{\\\"immunityTimeProperty\\\":{\\\"immunityTime\\\":800}},\\\"tokenDomains\\\":[\\\"google.com\\\",\\\"amazon.com\\\"],\\\"associationConfig\\\":{\\\"requestBody\\\":{\\\"CLOUDFRONT\\\":{\\\"defaultSizeInspectionLimit\\\":\\\"KB_16\\\"}}}}\" CAPTCHA and Challenge configs - If you update the policy's values for associationConfig, captchaConfig, challengeConfig, or tokenDomains, Firewall Manager will overwrite your local web ACLs to contain the new value(s). However, if you don't update the policy's associationConfig, captchaConfig, challengeConfig, or tokenDomains values, the values in your local web ACLs will remain unchanged. For information about association configs, see AssociationConfig. For information about CAPTCHA and Challenge configs, see CaptchaConfig and ChallengeConfig in the WAF API Reference. defaultSizeInspectionLimit - Specifies the maximum size of the web request body component that an associated Amazon CloudFront distribution should send to WAF for inspection. For more information, see DefaultSizeInspectionLimit in the WAF API Reference. Example: WAFV2 - Firewall Manager support for WAF managed rule group versioning \"{\\\"preProcessRuleGroups\\\":[{\\\"ruleGroupType\\\":\\\"ManagedRuleGroup\\\",\\\"overrideAction\\\":{\\\"type\\\":\\\"NONE\\\"},\\\"sampledRequestsEnabled\\\":true,\\\"managedRuleGroupIdentifier\\\":{\\\"managedRuleGroupName\\\":\\\"AWSManagedRulesAdminProtectionRuleSet\\\",\\\"vendorName\\\":\\\"AWS\\\",\\\"managedRuleGroupConfigs\\\":null}}],\\\"postProcessRuleGroups\\\":[],\\\"defaultAction\\\":{\\\"type\\\":\\\"ALLOW\\\"},\\\"customRequestHandling\\\":null,\\\"tokenDomains\\\":null,\\\"customResponse\\\":null,\\\"type\\\":\\\"WAFV2\\\",\\\"overrideCustomerWebACLAssociation\\\":false,\\\"sampledRequestsEnabledForDefaultActions\\\":true,\\\"optimizeUnassociatedWebACL\\\":true,\\\"webACLSource\\\":\\\"RETROFIT_EXISTING\\\"}\" To use a specific version of a WAF managed rule group in your Firewall Manager policy, you must set versionEnabled to true, and set version to the version you'd like to use. If you don't set versionEnabled to true, or if you omit versionEnabled, then Firewall Manager uses the default version of the WAF managed rule group. Example: WAFV2 - Logging configurations \"{\\\"type\\\":\\\"WAFV2\\\",\\\"preProcessRuleGroups\\\":[{\\\"ruleGroupArn\\\":null, \\\"overrideAction\\\":{\\\"type\\\":\\\"NONE\\\"},\\\"managedRuleGroupIdentifier\\\": {\\\"versionEnabled\\\":null,\\\"version\\\":null,\\\"vendorName\\\":\\\"AWS\\\", \\\"managedRuleGroupName\\\":\\\"AWSManagedRulesAdminProtectionRuleSet\\\"} ,\\\"ruleGroupType\\\":\\\"ManagedRuleGroup\\\",\\\"excludeRules\\\":[], \\\"sampledRequestsEnabled\\\":true}],\\\"postProcessRuleGroups\\\":[], \\\"defaultAction\\\":{\\\"type\\\":\\\"ALLOW\\\"},\\\"customRequestHandling\\\" :null,\\\"customResponse\\\":null,\\\"overrideCustomerWebACLAssociation\\\" :false,\\\"loggingConfiguration\\\":{\\\"logDestinationConfigs\\\": [\\\"arn:aws:s3:::aws-waf-logs-example-bucket\\\"] ,\\\"redactedFields\\\":[],\\\"loggingFilterConfigs\\\":{\\\"defaultBehavior\\\":\\\"KEEP\\\", \\\"filters\\\":[{\\\"behavior\\\":\\\"KEEP\\\",\\\"requirement\\\":\\\"MEETS_ALL\\\", \\\"conditions\\\":[{\\\"actionCondition\\\":\\\"CAPTCHA\\\"},{\\\"actionCondition\\\": \\\"CHALLENGE\\\"}, {\\\"actionCondition\\\":\\\"EXCLUDED_AS_COUNT\\\"}]}]}},\\\"sampledRequestsEnabledForDefaultActions\\\":true}\" Firewall Manager supports Amazon Kinesis Data Firehose and Amazon S3 as the logDestinationConfigs in your loggingConfiguration. For information about WAF logging configurations, see LoggingConfiguration in the WAF API Reference In the loggingConfiguration, you can specify one logDestinationConfigs. Optionally provide as many as 20 redactedFields. The RedactedFieldType must be one of URI, QUERY_STRING, HEADER, or METHOD. Example: WAF Classic \"{\\\"ruleGroups\\\":[{\\\"id\\\":\\\"78cb36c0-1b5e-4d7d-82b2-cf48d3ad9659\\\",\\\"overrideAction\\\":{\\\"type\\\":\\\"NONE\\\"}}],\\\"overrideCustomerWebACLAssociation\\\":true,\\\"defaultAction\\\":{\\\"type\\\":\\\"ALLOW\\\"},\\\"type\\\":\\\"WAF\\\"}\" PolicyOption (dict) --- Contains the settings to configure a network ACL policy, a Network Firewall firewall policy deployment model, or a third-party firewall policy. NetworkFirewallPolicy (dict) --- Defines the deployment model to use for the firewall policy. FirewallDeploymentModel (string) --- Defines the deployment model to use for the firewall policy. To use a distributed model, set PolicyOption to NULL. ThirdPartyFirewallPolicy (dict) --- Defines the policy options for a third-party firewall policy. FirewallDeploymentModel (string) --- Defines the deployment model to use for the third-party firewall policy. NetworkAclCommonPolicy (dict) --- Defines a Firewall Manager network ACL policy. The definition of the first and last rules for the network ACL policy. FirstEntries (list) --- The rules that you want to run first in the Firewall Manager managed network ACLs. You must specify at least one first entry or one last entry in any network ACL policy. (dict) --- Describes a rule in a network ACL. Each network ACL has a set of numbered ingress rules and a separate set of numbered egress rules. When determining whether a packet should be allowed in or out of a subnet associated with the network ACL, Amazon Web Services processes the entries in the network ACL according to the rule numbers, in ascending order. When you manage an individual network ACL, you explicitly specify the rule numbers. When you specify the network ACL rules in a Firewall Manager policy, you provide the rules to run first, in the order that you want them to run, and the rules to run last, in the order that you want them to run. Firewall Manager assigns the rule numbers for you when you save the network ACL policy specification. IcmpTypeCode (dict) --- ICMP protocol: The ICMP type and code. Code (integer) --- ICMP code. Type (integer) --- ICMP type. The protocol number. A value of '-1' means all protocols. PortRange (dict) --- TCP or UDP protocols: The range of ports the rule applies to. From (integer) --- The beginning port number of the range. To (integer) --- The ending port number of the range. CidrBlock (string) --- The IPv4 network range to allow or deny, in CIDR notation. Ipv6CidrBlock (string) --- The IPv6 network range to allow or deny, in CIDR notation. Indicates whether to allow or deny the traffic that matches the rule. Indicates whether the rule is an egress, or outbound, rule (applied to traffic leaving the subnet). If it's not an egress rule, then it's an ingress, or inbound, rule. Applies only when remediation is enabled for the policy as a whole. Firewall Manager uses this setting when it finds policy violations that involve conflicts between the custom entries and the policy entries. If forced remediation is disabled, Firewall Manager marks the network ACL as noncompliant and does not try to remediate. For more information about the remediation behavior, see Remediation for managed network ACLs in the Firewall Manager Developer Guide. LastEntries (list) --- The rules that you want to run last in the Firewall Manager managed network ACLs. The type of resource protected by or in scope of the policy. This is in the format shown in the Amazon Web Services Resource Types Reference. To apply this policy to multiple resource types, specify a resource type of ResourceTypeList and then specify the resource types in a ResourceTypeList. The following are valid resource types for each Firewall Manager policy type: Amazon Web Services WAF Classic - AWS::ApiGateway::Stage, AWS::CloudFront::Distribution, and AWS::ElasticLoadBalancingV2::LoadBalancer. WAF - AWS::ApiGateway::Stage, AWS::ElasticLoadBalancingV2::LoadBalancer, and AWS::CloudFront::Distribution. Shield Advanced - AWS::ElasticLoadBalancingV2::LoadBalancer, AWS::ElasticLoadBalancing::LoadBalancer, AWS::EC2::EIP, and AWS::CloudFront::Distribution. Network ACL - AWS::EC2::Subnet. Security group usage audit - AWS::EC2::SecurityGroup. Security group content audit - AWS::EC2::SecurityGroup, AWS::EC2::NetworkInterface, and AWS::EC2::Instance. DNS Firewall, Network Firewall, and third-party firewall - AWS::EC2::VPC. ResourceTypeList (list) --- An array of ResourceType objects. Use this only to specify multiple resource types. To specify a single resource type, use ResourceType. (string) --- ResourceTags (list) --- An array of ResourceTag objects. (dict) --- The resource tags that Firewall Manager uses to determine if a particular resource should be included or excluded from the Firewall Manager policy. Tags enable you to categorize your Amazon Web Services resources in different ways, for example, by purpose, owner, or environment. Each tag consists of a key and an optional value. If you add more than one tag to a policy, you can specify whether to combine them using the logical AND operator or the logical OR operator. For more information, see Working with Tag Editor. Every resource tag must have a string value, either a non-empty string or an empty string. If you don't provide a value for a resource tag, Firewall Manager saves the value as an empty string: ''. When Firewall Manager compares tags, it only matches two tags if they have the same key and the same value. A tag with an empty string value only matches with tags that also have an empty string value. The resource tag key. Value (string) --- The resource tag value. To specify an empty string value, either don't provide this or specify it as ''. If set to True, resources with the tags that are specified in the ResourceTag array are not in scope of the policy. If set to False, and the ResourceTag array is not null, only resources with the specified tags are in scope of the policy. Indicates if the policy should be automatically applied to new resources. DeleteUnusedFMManagedResources (boolean) --- Indicates whether Firewall Manager should automatically remove protections from resources that leave the policy scope and clean up resources that Firewall Manager is managing for accounts when those accounts leave policy scope. For example, Firewall Manager will disassociate a Firewall Manager managed web ACL from a protected customer resource when the customer resource leaves policy scope. By default, Firewall Manager doesn't remove protections or delete Firewall Manager managed resources. This option is not available for Shield Advanced or WAF Classic policies. IncludeMap (dict) --- Specifies the Amazon Web Services account IDs and Organizations organizational units (OUs) to include in the policy. Specifying an OU is the equivalent of specifying all accounts in the OU and in any of its child OUs, including any child OUs and accounts that are added at a later time. You can specify inclusions or exclusions, but not both. If you specify an IncludeMap, Firewall Manager applies the policy to all accounts specified by the IncludeMap, and does not evaluate any ExcludeMap specifications. If you do not specify an IncludeMap, then Firewall Manager applies the policy to all accounts except for those specified by the ExcludeMap. You can specify account IDs, OUs, or a combination: Specify account IDs by setting the key to ACCOUNT. For example, the following is a valid map: {'ACCOUNT' : ['accountID1', 'accountID2']}. Specify OUs by setting the key to ORG_UNIT. For example, the following is a valid map: {'ORG_UNIT' : ['ouid111', 'ouid112']}. Specify accounts and OUs together in a single map, separated with a comma. For example, the following is a valid map: {'ACCOUNT' : ['accountID1', 'accountID2'], 'ORG_UNIT' : ['ouid111', 'ouid112']}. (string) --- (list) --- (string) --- ExcludeMap (dict) --- Specifies the Amazon Web Services account IDs and Organizations organizational units (OUs) to exclude from the policy. (string) --- (list) --- (string) --- ResourceSetIds (list) --- The unique identifiers of the resource sets used by the policy. (string) --- PolicyDescription (string) --- Your description of the Firewall Manager policy. PolicyStatus (string) --- Indicates whether the policy is in or out of an admin's policy or Region scope. ACTIVE - The administrator can manage and delete the policy. OUT_OF_ADMIN_SCOPE - The administrator can view the policy, but they can't edit or delete the policy. Existing policy protections stay in place. Any new resources that come into scope of the policy won't be protected. ResourceTagLogicalOperator (string) --- Specifies whether to combine multiple resource tags with AND, so that a resource must have all tags to be included or excluded, or OR, so that a resource must have at least one tag. Default: AND.",
      "nested_params": [
        {
          "name": "PolicyId",
          "type": "string",
          "required": false,
          "description": "The ID of the Firewall Manager policy.",
          "nested_params": []
        },
        {
          "name": "PolicyName",
          "type": "string",
          "required": false,
          "description": "The name of the Firewall Manager policy.",
          "nested_params": []
        },
        {
          "name": "PolicyUpdateToken",
          "type": "string",
          "required": false,
          "description": "A unique identifier for each update to the policy. When issuing a PutPolicy request, the PolicyUpdateToken in the request must match the PolicyUpdateToken of the current policy version. To get the PolicyUpdateToken of the current policy version, use a GetPolicy request.",
          "nested_params": []
        },
        {
          "name": "SecurityServicePolicyData",
          "type": "dict",
          "required": false,
          "description": "Details about the security service that is being used to protect the resources.",
          "nested_params": [
            {
              "name": "Type",
              "type": "string",
              "required": false,
              "description": "The service that the policy is using to protect the resources. This specifies the type of policy that is created, either an WAF policy, a Shield Advanced policy, or a security group policy. For security group policies, Firewall Manager supports one security group for each common policy and for each content audit policy. This is an adjustable limit that you can increase by contacting Amazon Web Services Support.",
              "nested_params": []
            },
            {
              "name": "ManagedServiceData",
              "type": "string",
              "required": false,
              "description": "Details about the service that are specific to the service type, in JSON format.",
              "nested_params": []
            },
            {
              "name": "PolicyOption",
              "type": "dict",
              "required": false,
              "description": "Contains the settings to configure a network ACL policy, a Network Firewall firewall policy deployment model, or a third-party firewall policy.",
              "nested_params": [
                {
                  "name": "NetworkFirewallPolicy",
                  "type": "dict",
                  "required": false,
                  "description": "Defines the deployment model to use for the firewall policy.",
                  "nested_params": [
                    {
                      "name": "FirewallDeploymentModel",
                      "type": "string",
                      "required": false,
                      "description": "Defines the deployment model to use for the firewall policy. To use a distributed model, set PolicyOption to NULL.",
                      "nested_params": []
                    }
                  ]
                },
                {
                  "name": "ThirdPartyFirewallPolicy",
                  "type": "dict",
                  "required": false,
                  "description": "Defines the policy options for a third-party firewall policy.",
                  "nested_params": [
                    {
                      "name": "FirewallDeploymentModel",
                      "type": "string",
                      "required": false,
                      "description": "Defines the deployment model to use for the third-party firewall policy.",
                      "nested_params": []
                    }
                  ]
                },
                {
                  "name": "NetworkAclCommonPolicy",
                  "type": "dict",
                  "required": false,
                  "description": "Defines a Firewall Manager network ACL policy.",
                  "nested_params": [
                    {
                      "name": "NetworkAclEntrySet",
                      "type": "dict",
                      "required": false,
                      "description": "The definition of the first and last rules for the network ACL policy.",
                      "nested_params": [
                        {
                          "name": "FirstEntries",
                          "type": "list",
                          "required": false,
                          "description": "The rules that you want to run first in the Firewall Manager managed network ACLs. You must specify at least one first entry or one last entry in any network ACL policy.",
                          "nested_params": [
                            {
                              "name": "IcmpTypeCode",
                              "type": "dict",
                              "required": false,
                              "description": "ICMP protocol: The ICMP type and code.",
                              "nested_params": [
                                {
                                  "name": "Code",
                                  "type": "integer",
                                  "required": false,
                                  "description": "ICMP code.",
                                  "nested_params": []
                                },
                                {
                                  "name": "Type",
                                  "type": "integer",
                                  "required": false,
                                  "description": "ICMP type.",
                                  "nested_params": []
                                }
                              ]
                            },
                            {
                              "name": "Protocol",
                              "type": "string",
                              "required": false,
                              "description": "The protocol number. A value of '-1' means all protocols.",
                              "nested_params": []
                            },
                            {
                              "name": "PortRange",
                              "type": "dict",
                              "required": false,
                              "description": "TCP or UDP protocols: The range of ports the rule applies to.",
                              "nested_params": [
                                {
                                  "name": "From",
                                  "type": "integer",
                                  "required": false,
                                  "description": "The beginning port number of the range.",
                                  "nested_params": []
                                },
                                {
                                  "name": "To",
                                  "type": "integer",
                                  "required": false,
                                  "description": "The ending port number of the range.",
                                  "nested_params": []
                                }
                              ]
                            },
                            {
                              "name": "CidrBlock",
                              "type": "string",
                              "required": false,
                              "description": "The IPv4 network range to allow or deny, in CIDR notation.",
                              "nested_params": []
                            },
                            {
                              "name": "Ipv6CidrBlock",
                              "type": "string",
                              "required": false,
                              "description": "The IPv6 network range to allow or deny, in CIDR notation.",
                              "nested_params": []
                            },
                            {
                              "name": "RuleAction",
                              "type": "string",
                              "required": false,
                              "description": "Indicates whether to allow or deny the traffic that matches the rule.",
                              "nested_params": []
                            },
                            {
                              "name": "Egress",
                              "type": "boolean",
                              "required": false,
                              "description": "Indicates whether the rule is an egress, or outbound, rule (applied to traffic leaving the subnet). If it's not an egress rule, then it's an ingress, or inbound, rule.",
                              "nested_params": []
                            }
                          ]
                        },
                        {
                          "name": "ForceRemediateForFirstEntries",
                          "type": "boolean",
                          "required": false,
                          "description": "Applies only when remediation is enabled for the policy as a whole. Firewall Manager uses this setting when it finds policy violations that involve conflicts between the custom entries and the policy entries. If forced remediation is disabled, Firewall Manager marks the network ACL as noncompliant and does not try to remediate. For more information about the remediation behavior, see Remediation for managed network ACLs in the Firewall Manager Developer Guide.",
                          "nested_params": []
                        },
                        {
                          "name": "LastEntries",
                          "type": "list",
                          "required": false,
                          "description": "The rules that you want to run last in the Firewall Manager managed network ACLs. You must specify at least one first entry or one last entry in any network ACL policy.",
                          "nested_params": [
                            {
                              "name": "IcmpTypeCode",
                              "type": "dict",
                              "required": false,
                              "description": "ICMP protocol: The ICMP type and code.",
                              "nested_params": [
                                {
                                  "name": "Code",
                                  "type": "integer",
                                  "required": false,
                                  "description": "ICMP code.",
                                  "nested_params": []
                                },
                                {
                                  "name": "Type",
                                  "type": "integer",
                                  "required": false,
                                  "description": "ICMP type.",
                                  "nested_params": []
                                }
                              ]
                            },
                            {
                              "name": "Protocol",
                              "type": "string",
                              "required": false,
                              "description": "The protocol number. A value of '-1' means all protocols.",
                              "nested_params": []
                            },
                            {
                              "name": "PortRange",
                              "type": "dict",
                              "required": false,
                              "description": "TCP or UDP protocols: The range of ports the rule applies to.",
                              "nested_params": [
                                {
                                  "name": "From",
                                  "type": "integer",
                                  "required": false,
                                  "description": "The beginning port number of the range.",
                                  "nested_params": []
                                },
                                {
                                  "name": "To",
                                  "type": "integer",
                                  "required": false,
                                  "description": "The ending port number of the range.",
                                  "nested_params": []
                                }
                              ]
                            },
                            {
                              "name": "CidrBlock",
                              "type": "string",
                              "required": false,
                              "description": "The IPv4 network range to allow or deny, in CIDR notation.",
                              "nested_params": []
                            },
                            {
                              "name": "Ipv6CidrBlock",
                              "type": "string",
                              "required": false,
                              "description": "The IPv6 network range to allow or deny, in CIDR notation.",
                              "nested_params": []
                            },
                            {
                              "name": "RuleAction",
                              "type": "string",
                              "required": false,
                              "description": "Indicates whether to allow or deny the traffic that matches the rule.",
                              "nested_params": []
                            },
                            {
                              "name": "Egress",
                              "type": "boolean",
                              "required": false,
                              "description": "Indicates whether the rule is an egress, or outbound, rule (applied to traffic leaving the subnet). If it's not an egress rule, then it's an ingress, or inbound, rule.",
                              "nested_params": []
                            }
                          ]
                        },
                        {
                          "name": "ForceRemediateForLastEntries",
                          "type": "boolean",
                          "required": false,
                          "description": "Applies only when remediation is enabled for the policy as a whole. Firewall Manager uses this setting when it finds policy violations that involve conflicts between the custom entries and the policy entries. If forced remediation is disabled, Firewall Manager marks the network ACL as noncompliant and does not try to remediate. For more information about the remediation behavior, see Remediation for managed network ACLs in the Firewall Manager Developer Guide.",
                          "nested_params": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "ResourceType",
          "type": "string",
          "required": false,
          "description": "The type of resource protected by or in scope of the policy. This is in the format shown in the Amazon Web Services Resource Types Reference. To apply this policy to multiple resource types, specify a resource type of ResourceTypeList and then specify the resource types in a ResourceTypeList. The following are valid resource types for each Firewall Manager policy type:",
          "nested_params": []
        },
        {
          "name": "ResourceTypeList",
          "type": "list",
          "required": false,
          "description": "An array of ResourceType objects. Use this only to specify multiple resource types. To specify a single resource type, use ResourceType.",
          "nested_params": []
        },
        {
          "name": "ResourceTags",
          "type": "list",
          "required": false,
          "description": "An array of ResourceTag objects.",
          "nested_params": [
            {
              "name": "Key",
              "type": "string",
              "required": false,
              "description": "The resource tag key.",
              "nested_params": []
            },
            {
              "name": "Value",
              "type": "string",
              "required": false,
              "description": "The resource tag value. To specify an empty string value, either don't provide this or specify it as ''.",
              "nested_params": []
            }
          ]
        },
        {
          "name": "ExcludeResourceTags",
          "type": "boolean",
          "required": false,
          "description": "If set to True, resources with the tags that are specified in the ResourceTag array are not in scope of the policy. If set to False, and the ResourceTag array is not null, only resources with the specified tags are in scope of the policy.",
          "nested_params": []
        },
        {
          "name": "RemediationEnabled",
          "type": "boolean",
          "required": false,
          "description": "Indicates if the policy should be automatically applied to new resources.",
          "nested_params": []
        },
        {
          "name": "DeleteUnusedFMManagedResources",
          "type": "boolean",
          "required": false,
          "description": "Indicates whether Firewall Manager should automatically remove protections from resources that leave the policy scope and clean up resources that Firewall Manager is managing for accounts when those accounts leave policy scope. For example, Firewall Manager will disassociate a Firewall Manager managed web ACL from a protected customer resource when the customer resource leaves policy scope. By default, Firewall Manager doesn't remove protections or delete Firewall Manager managed resources. This option is not available for Shield Advanced or WAF Classic policies.",
          "nested_params": []
        },
        {
          "name": "IncludeMap",
          "type": "dict",
          "required": false,
          "description": "Specifies the Amazon Web Services account IDs and Organizations organizational units (OUs) to include in the policy. Specifying an OU is the equivalent of specifying all accounts in the OU and in any of its child OUs, including any child OUs and accounts that are added at a later time. You can specify inclusions or exclusions, but not both. If you specify an IncludeMap, Firewall Manager applies the policy to all accounts specified by the IncludeMap, and does not evaluate any ExcludeMap specifications. If you do not specify an IncludeMap, then Firewall Manager applies the policy to all accounts except for those specified by the ExcludeMap. You can specify account IDs, OUs, or a combination:",
          "nested_params": []
        },
        {
          "name": "ExcludeMap",
          "type": "dict",
          "required": false,
          "description": "Specifies the Amazon Web Services account IDs and Organizations organizational units (OUs) to exclude from the policy. Specifying an OU is the equivalent of specifying all accounts in the OU and in any of its child OUs, including any child OUs and accounts that are added at a later time. You can specify inclusions or exclusions, but not both. If you specify an IncludeMap, Firewall Manager applies the policy to all accounts specified by the IncludeMap, and does not evaluate any ExcludeMap specifications. If you do not specify an IncludeMap, then Firewall Manager applies the policy to all accounts except for those specified by the ExcludeMap. You can specify account IDs, OUs, or a combination:",
          "nested_params": []
        },
        {
          "name": "ResourceSetIds",
          "type": "list",
          "required": false,
          "description": "The unique identifiers of the resource sets used by the policy.",
          "nested_params": []
        },
        {
          "name": "PolicyDescription",
          "type": "string",
          "required": false,
          "description": "Your description of the Firewall Manager policy.",
          "nested_params": []
        },
        {
          "name": "PolicyStatus",
          "type": "string",
          "required": false,
          "description": "Indicates whether the policy is in or out of an admin's policy or Region scope.",
          "nested_params": []
        },
        {
          "name": "ResourceTagLogicalOperator",
          "type": "string",
          "required": false,
          "description": "Specifies whether to combine multiple resource tags with AND, so that a resource must have all tags to be included or excluded, or OR, so that a resource must have at least one tag. Default: AND.",
          "nested_params": []
        }
      ]
    },
    {
      "name": "TagList",
      "type": "list",
      "required": true,
      "description": "The tags to add to the Amazon Web Services resource. (dict) --- A collection of key:value pairs associated with an Amazon Web Services resource. The key:value pair can be anything you define. Typically, the tag key represents a category (such as 'environment') and the tag value represents a specific value within that category (such as 'test,' 'development,' or 'production'). You can add up to 50 tags to each Amazon Web Services resource. Part of the key:value pair that defines a tag. You can use a tag key to describe a category of information, such as 'customer.' Tag keys are case-sensitive. You can use a tag value to describe a specific value within a category, such as 'companyA' or 'companyB.' Tag values are case-sensitive.",
      "nested_params": [
        {
          "name": "Key",
          "type": "string",
          "required": false,
          "description": "Part of the key:value pair that defines a tag. You can use a tag key to describe a category of information, such as 'customer.' Tag keys are case-sensitive.",
          "nested_params": []
        },
        {
          "name": "Value",
          "type": "string",
          "required": false,
          "description": "Part of the key:value pair that defines a tag. You can use a tag value to describe a specific value within a category, such as 'companyA' or 'companyB.' Tag values are case-sensitive.",
          "nested_params": []
        }
      ]
    }
  ],
  "return_structure": [
    {
      "name": "",
      "type": "dict",
      "description": "",
      "nested_items": [
        {
          "name": "",
          "type": "dict",
          "description": "",
          "nested_items": [
            {
              "name": "PolicyId",
              "type": "string",
              "description": "The ID of the Firewall Manager policy.",
              "nested_items": []
            },
            {
              "name": "PolicyName",
              "type": "string",
              "description": "The name of the Firewall Manager policy.",
              "nested_items": []
            },
            {
              "name": "PolicyUpdateToken",
              "type": "string",
              "description": "A unique identifier for each update to the policy. When issuing a PutPolicy request, the PolicyUpdateToken in the request must match the PolicyUpdateToken of the current policy version. To get the PolicyUpdateToken of the current policy version, use a GetPolicy request.",
              "nested_items": []
            },
            {
              "name": "SecurityServicePolicyData",
              "type": "dict",
              "description": "Details about the security service that is being used to protect the resources.",
              "nested_items": [
                {
                  "name": "Type",
                  "type": "string",
                  "description": "The service that the policy is using to protect the resources. This specifies the type of policy that is created, either an WAF policy, a Shield Advanced policy, or a security group policy. For security group policies, Firewall Manager supports one security group for each common policy and for each content audit policy. This is an adjustable limit that you can increase by contacting Amazon Web Services Support.",
                  "nested_items": []
                },
                {
                  "name": "ManagedServiceData",
                  "type": "string",
                  "description": "Details about the service that are specific to the service type, in JSON format.",
                  "nested_items": [
                    {
                      "name": "",
                      "type": "",
                      "description": "Example: DNS_FIREWALL \"{\\\"type\\\":\\\"DNS_FIREWALL\\\",\\\"preProcessRuleGroups\\\":[{\\\"ruleGroupId\\\":\\\"rslvr-frg-1\\\",\\\"priority\\\":10}],\\\"postProcessRuleGroups\\\":[{\\\"ruleGroupId\\\":\\\"rslvr-frg-2\\\",\\\"priority\\\":9911}]}\"",
                      "nested_items": []
                    }
                  ]
                },
                {
                  "name": "PolicyOption",
                  "type": "dict",
                  "description": "Contains the settings to configure a network ACL policy, a Network Firewall firewall policy deployment model, or a third-party firewall policy.",
                  "nested_items": [
                    {
                      "name": "NetworkFirewallPolicy",
                      "type": "dict",
                      "description": "Defines the deployment model to use for the firewall policy.",
                      "nested_items": [
                        {
                          "name": "FirewallDeploymentModel",
                          "type": "string",
                          "description": "Defines the deployment model to use for the firewall policy. To use a distributed model, set PolicyOption to NULL.",
                          "nested_items": []
                        }
                      ]
                    },
                    {
                      "name": "ThirdPartyFirewallPolicy",
                      "type": "dict",
                      "description": "Defines the policy options for a third-party firewall policy.",
                      "nested_items": [
                        {
                          "name": "FirewallDeploymentModel",
                          "type": "string",
                          "description": "Defines the deployment model to use for the third-party firewall policy.",
                          "nested_items": []
                        }
                      ]
                    },
                    {
                      "name": "NetworkAclCommonPolicy",
                      "type": "dict",
                      "description": "Defines a Firewall Manager network ACL policy.",
                      "nested_items": [
                        {
                          "name": "NetworkAclEntrySet",
                          "type": "dict",
                          "description": "The definition of the first and last rules for the network ACL policy.",
                          "nested_items": [
                            {
                              "name": "FirstEntries",
                              "type": "list",
                              "description": "The rules that you want to run first in the Firewall Manager managed network ACLs.",
                              "nested_items": [
                                {
                                  "name": "",
                                  "type": "dict",
                                  "description": "",
                                  "nested_items": [
                                    {
                                      "name": "IcmpTypeCode",
                                      "type": "dict",
                                      "description": "ICMP protocol: The ICMP type and code.",
                                      "nested_items": [
                                        {
                                          "name": "Code",
                                          "type": "integer",
                                          "description": "ICMP code.",
                                          "nested_items": []
                                        },
                                        {
                                          "name": "Type",
                                          "type": "integer",
                                          "description": "ICMP type.",
                                          "nested_items": []
                                        }
                                      ]
                                    },
                                    {
                                      "name": "Protocol",
                                      "type": "string",
                                      "description": "The protocol number. A value of '-1' means all protocols.",
                                      "nested_items": []
                                    },
                                    {
                                      "name": "PortRange",
                                      "type": "dict",
                                      "description": "TCP or UDP protocols: The range of ports the rule applies to.",
                                      "nested_items": [
                                        {
                                          "name": "From",
                                          "type": "integer",
                                          "description": "The beginning port number of the range.",
                                          "nested_items": []
                                        },
                                        {
                                          "name": "To",
                                          "type": "integer",
                                          "description": "The ending port number of the range.",
                                          "nested_items": []
                                        }
                                      ]
                                    },
                                    {
                                      "name": "CidrBlock",
                                      "type": "string",
                                      "description": "The IPv4 network range to allow or deny, in CIDR notation.",
                                      "nested_items": []
                                    },
                                    {
                                      "name": "Ipv6CidrBlock",
                                      "type": "string",
                                      "description": "The IPv6 network range to allow or deny, in CIDR notation.",
                                      "nested_items": []
                                    },
                                    {
                                      "name": "RuleAction",
                                      "type": "string",
                                      "description": "Indicates whether to allow or deny the traffic that matches the rule.",
                                      "nested_items": []
                                    },
                                    {
                                      "name": "Egress",
                                      "type": "boolean",
                                      "description": "Indicates whether the rule is an egress, or outbound, rule (applied to traffic leaving the subnet). If it's not an egress rule, then it's an ingress, or inbound, rule.",
                                      "nested_items": []
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "name": "ForceRemediateForFirstEntries",
                              "type": "boolean",
                              "description": "Applies only when remediation is enabled for the policy as a whole. Firewall Manager uses this setting when it finds policy violations that involve conflicts between the custom entries and the policy entries.",
                              "nested_items": []
                            },
                            {
                              "name": "LastEntries",
                              "type": "list",
                              "description": "The rules that you want to run last in the Firewall Manager managed network ACLs.",
                              "nested_items": [
                                {
                                  "name": "",
                                  "type": "dict",
                                  "description": "",
                                  "nested_items": [
                                    {
                                      "name": "IcmpTypeCode",
                                      "type": "dict",
                                      "description": "ICMP protocol: The ICMP type and code.",
                                      "nested_items": [
                                        {
                                          "name": "Code",
                                          "type": "integer",
                                          "description": "ICMP code.",
                                          "nested_items": []
                                        },
                                        {
                                          "name": "Type",
                                          "type": "integer",
                                          "description": "ICMP type.",
                                          "nested_items": []
                                        }
                                      ]
                                    },
                                    {
                                      "name": "Protocol",
                                      "type": "string",
                                      "description": "The protocol number. A value of '-1' means all protocols.",
                                      "nested_items": []
                                    },
                                    {
                                      "name": "PortRange",
                                      "type": "dict",
                                      "description": "TCP or UDP protocols: The range of ports the rule applies to.",
                                      "nested_items": [
                                        {
                                          "name": "From",
                                          "type": "integer",
                                          "description": "The beginning port number of the range.",
                                          "nested_items": []
                                        },
                                        {
                                          "name": "To",
                                          "type": "integer",
                                          "description": "The ending port number of the range.",
                                          "nested_items": []
                                        }
                                      ]
                                    },
                                    {
                                      "name": "CidrBlock",
                                      "type": "string",
                                      "description": "The IPv4 network range to allow or deny, in CIDR notation.",
                                      "nested_items": []
                                    },
                                    {
                                      "name": "Ipv6CidrBlock",
                                      "type": "string",
                                      "description": "The IPv6 network range to allow or deny, in CIDR notation.",
                                      "nested_items": []
                                    },
                                    {
                                      "name": "RuleAction",
                                      "type": "string",
                                      "description": "Indicates whether to allow or deny the traffic that matches the rule.",
                                      "nested_items": []
                                    },
                                    {
                                      "name": "Egress",
                                      "type": "boolean",
                                      "description": "Indicates whether the rule is an egress, or outbound, rule (applied to traffic leaving the subnet). If it's not an egress rule, then it's an ingress, or inbound, rule.",
                                      "nested_items": []
                                    }
                                  ]
                                }
                              ]
                            },
                            {
                              "name": "ForceRemediateForLastEntries",
                              "type": "boolean",
                              "description": "Applies only when remediation is enabled for the policy as a whole. Firewall Manager uses this setting when it finds policy violations that involve conflicts between the custom entries and the policy entries.",
                              "nested_items": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "ResourceType",
              "type": "string",
              "description": "The type of resource protected by or in scope of the policy. This is in the format shown in the Amazon Web Services Resource Types Reference. To apply this policy to multiple resource types, specify a resource type of ResourceTypeList and then specify the resource types in a ResourceTypeList.",
              "nested_items": [
                {
                  "name": "",
                  "type": "",
                  "description": "Amazon Web Services WAF Classic - AWS::ApiGateway::Stage, AWS::CloudFront::Distribution, and AWS::ElasticLoadBalancingV2::LoadBalancer.",
                  "nested_items": []
                },
                {
                  "name": "",
                  "type": "",
                  "description": "WAF - AWS::ApiGateway::Stage, AWS::ElasticLoadBalancingV2::LoadBalancer, and AWS::CloudFront::Distribution.",
                  "nested_items": []
                },
                {
                  "name": "",
                  "type": "",
                  "description": "Shield Advanced - AWS::ElasticLoadBalancingV2::LoadBalancer, AWS::ElasticLoadBalancing::LoadBalancer, AWS::EC2::EIP, and AWS::CloudFront::Distribution.",
                  "nested_items": []
                },
                {
                  "name": "",
                  "type": "",
                  "description": "Network ACL - AWS::EC2::Subnet.",
                  "nested_items": []
                },
                {
                  "name": "",
                  "type": "",
                  "description": "Security group usage audit - AWS::EC2::SecurityGroup.",
                  "nested_items": []
                },
                {
                  "name": "",
                  "type": "",
                  "description": "Security group content audit - AWS::EC2::SecurityGroup, AWS::EC2::NetworkInterface, and AWS::EC2::Instance.",
                  "nested_items": []
                },
                {
                  "name": "",
                  "type": "",
                  "description": "DNS Firewall, Network Firewall, and third-party firewall - AWS::EC2::VPC.",
                  "nested_items": []
                }
              ]
            },
            {
              "name": "ResourceTypeList",
              "type": "list",
              "description": "An array of ResourceType objects. Use this only to specify multiple resource types. To specify a single resource type, use ResourceType.",
              "nested_items": [
                {
                  "name": "",
                  "type": "string",
                  "description": "(string) ---",
                  "nested_items": []
                }
              ]
            },
            {
              "name": "ResourceTags",
              "type": "list",
              "description": "An array of ResourceTag objects.",
              "nested_items": [
                {
                  "name": "",
                  "type": "dict",
                  "description": "",
                  "nested_items": [
                    {
                      "name": "Key",
                      "type": "string",
                      "description": "The resource tag key.",
                      "nested_items": []
                    },
                    {
                      "name": "Value",
                      "type": "string",
                      "description": "The resource tag value. To specify an empty string value, either don't provide this or specify it as ''.",
                      "nested_items": []
                    }
                  ]
                }
              ]
            },
            {
              "name": "ExcludeResourceTags",
              "type": "boolean",
              "description": "If set to True, resources with the tags that are specified in the ResourceTag array are not in scope of the policy. If set to False, and the ResourceTag array is not null, only resources with the specified tags are in scope of the policy.",
              "nested_items": []
            },
            {
              "name": "RemediationEnabled",
              "type": "boolean",
              "description": "Indicates if the policy should be automatically applied to new resources.",
              "nested_items": []
            },
            {
              "name": "DeleteUnusedFMManagedResources",
              "type": "boolean",
              "description": "Indicates whether Firewall Manager should automatically remove protections from resources that leave the policy scope and clean up resources that Firewall Manager is managing for accounts when those accounts leave policy scope. For example, Firewall Manager will disassociate a Firewall Manager managed web ACL from a protected customer resource when the customer resource leaves policy scope.",
              "nested_items": []
            },
            {
              "name": "IncludeMap",
              "type": "dict",
              "description": "Specifies the Amazon Web Services account IDs and Organizations organizational units (OUs) to include in the policy. Specifying an OU is the equivalent of specifying all accounts in the OU and in any of its child OUs, including any child OUs and accounts that are added at a later time.",
              "nested_items": [
                {
                  "name": "",
                  "type": "",
                  "description": "Specify account IDs by setting the key to ACCOUNT. For example, the following is a valid map: {'ACCOUNT' : ['accountID1', 'accountID2']}.",
                  "nested_items": []
                },
                {
                  "name": "",
                  "type": "",
                  "description": "Specify OUs by setting the key to ORG_UNIT. For example, the following is a valid map: {'ORG_UNIT' : ['ouid111', 'ouid112']}.",
                  "nested_items": []
                },
                {
                  "name": "",
                  "type": "",
                  "description": "Specify accounts and OUs together in a single map, separated with a comma. For example, the following is a valid map: {'ACCOUNT' : ['accountID1', 'accountID2'], 'ORG_UNIT' : ['ouid111', 'ouid112']}.",
                  "nested_items": []
                }
              ]
            },
            {
              "name": "ExcludeMap",
              "type": "dict",
              "description": "Specifies the Amazon Web Services account IDs and Organizations organizational units (OUs) to exclude from the policy. Specifying an OU is the equivalent of specifying all accounts in the OU and in any of its child OUs, including any child OUs and accounts that are added at a later time.",
              "nested_items": [
                {
                  "name": "",
                  "type": "",
                  "description": "Specify account IDs by setting the key to ACCOUNT. For example, the following is a valid map: {'ACCOUNT' : ['accountID1', 'accountID2']}.",
                  "nested_items": []
                },
                {
                  "name": "",
                  "type": "",
                  "description": "Specify OUs by setting the key to ORG_UNIT. For example, the following is a valid map: {'ORG_UNIT' : ['ouid111', 'ouid112']}.",
                  "nested_items": []
                },
                {
                  "name": "",
                  "type": "",
                  "description": "Specify accounts and OUs together in a single map, separated with a comma. For example, the following is a valid map: {'ACCOUNT' : ['accountID1', 'accountID2'], 'ORG_UNIT' : ['ouid111', 'ouid112']}.",
                  "nested_items": []
                }
              ]
            },
            {
              "name": "ResourceSetIds",
              "type": "list",
              "description": "The unique identifiers of the resource sets used by the policy.",
              "nested_items": [
                {
                  "name": "",
                  "type": "string",
                  "description": "(string) ---",
                  "nested_items": []
                }
              ]
            },
            {
              "name": "PolicyDescription",
              "type": "string",
              "description": "Your description of the Firewall Manager policy.",
              "nested_items": []
            },
            {
              "name": "PolicyStatus",
              "type": "string",
              "description": "Indicates whether the policy is in or out of an admin's policy or Region scope.",
              "nested_items": [
                {
                  "name": "",
                  "type": "",
                  "description": "ACTIVE - The administrator can manage and delete the policy.",
                  "nested_items": []
                },
                {
                  "name": "",
                  "type": "",
                  "description": "OUT_OF_ADMIN_SCOPE - The administrator can view the policy, but they can't edit or delete the policy. Existing policy protections stay in place. Any new resources that come into scope of the policy won't be protected.",
                  "nested_items": []
                }
              ]
            },
            {
              "name": "ResourceTagLogicalOperator",
              "type": "string",
              "description": "Specifies whether to combine multiple resource tags with AND, so that a resource must have all tags to be included or excluded, or OR, so that a resource must have at least one tag.",
              "nested_items": []
            }
          ]
        },
        {
          "name": "PolicyArn",
          "type": "string",
          "description": "The Amazon Resource Name (ARN) of the policy.",
          "nested_items": []
        }
      ]
    }
  ]
}