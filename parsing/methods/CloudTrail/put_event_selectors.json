{
  "method_name": "put_event_selectors",
  "url": "https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/cloudtrail/client/put_event_selectors.html",
  "description": "Configures event selectors (also referred to as basic event selectors) or advanced event selectors for your trail. You can use either AdvancedEventSelectors or EventSelectors, but not both. If you apply AdvancedEventSelectors to a trail, any existing EventSelectors are overwritten. You can use AdvancedEventSelectors to log management events, data events for all resource types, and network activity events. You can use EventSelectors to log management events and data events for the following resource types: You can't use EventSelectors to log network activity events. If you want your trail to log Insights events, be sure the event selector or advanced event selector enables logging of the Insights event types you want configured for your trail. For more information about logging Insights events, see Working with CloudTrail Insights in the CloudTrail User Guide. By default, trails created without specific event selectors are configured to log all read and write management events, and no data events or network activity events. When an event occurs in your account, CloudTrail evaluates the event selectors or advanced event selectors in all trails. For each trail, if the event matches any event selector, the trail processes and logs the event. If the event doesn't match any event selector, the trail doesn't log the event. Example. The PutEventSelectors operation must be called from the Region in which the trail was created; otherwise, an InvalidHomeRegionException exception is thrown. You can configure up to five event selectors for each trail. You can add advanced event selectors, and conditions for your advanced event selectors, up to a maximum of 500 values for all conditions and selectors on a trail. For more information, see Logging management events, Logging data events, Logging network activity events, and Quotas in CloudTrail in the CloudTrail User Guide.",
  "parameters": [
    {
      "name": "TrailName",
      "type": "string",
      "required": true,
      "description": "Specifies the name of the trail or trail ARN. If you specify a trail name, the string must meet the following requirements: Contain only ASCII letters (a-z, A-Z), numbers (0-9), periods (.), underscores (_), or dashes (-) Start with a letter or number, and end with a letter or number Be between 3 and 128 characters Have no adjacent periods, underscores or dashes. Names like my-_namespace and my--namespace are not valid. Not be in IP address format (for example, 192.168.5.4) If you specify a trail ARN, it must be in the following format. arn:aws:cloudtrail:us-east-2:123456789012:trail/MyTrail.",
      "nested_params": []
    },
    {
      "name": "EventSelectors",
      "type": "list",
      "required": false,
      "description": "Specifies the settings for your event selectors. You can use event selectors to log management events and data events for the following resource types: AWS::DynamoDB::Table AWS::Lambda::Function AWS::S3::Object You can't use event selectors to log network activity events. You can configure up to five event selectors for a trail. You can use either EventSelectors or AdvancedEventSelectors in a PutEventSelectors request, but not both. If you apply EventSelectors to a trail, any existing AdvancedEventSelectors are overwritten. (dict) --- Use event selectors to further specify the management and data event settings for your trail. By default, trails created without specific event selectors will be configured to log all read and write management events, and no data events. When an event occurs in your account, CloudTrail evaluates the event selector for all trails. For each trail, if the event matches any event selector, the trail processes and logs the event. If the event doesn't match any event selector, the trail doesn't log the event. You cannot apply both event selectors and advanced event selectors to a trail. ReadWriteType (string) --- Specify if you want your trail to log read-only events, write-only events, or all. For example, the EC2 GetConsoleOutput is a read-only API operation and RunInstances is a write-only API operation. By default, the value is All. IncludeManagementEvents (boolean) --- Specify if you want your event selector to include management events for your trail. For more information, see Management Events in the CloudTrail User Guide. By default, the value is true. The first copy of management events is free. You are charged for additional copies of management events that you are logging on any subsequent trail in the same Region. For more information about CloudTrail pricing, see CloudTrail Pricing. DataResources (list) --- CloudTrail supports data event logging for Amazon S3 objects in standard S3 buckets, Lambda functions, and Amazon DynamoDB tables with basic event selectors. You can specify up to 250 resources for an individual event selector, but the total number of data resources cannot exceed 250 across all event selectors in a trail. This limit does not apply if you configure resource logging for all data events. For more information, see Data Events and Limits in CloudTrail in the CloudTrail User Guide. (dict) --- You can configure the DataResource in an EventSelector to log data events for the following three resource types: AWS::DynamoDB::Table AWS::Lambda::Function AWS::S3::Object To log data events for all other resource types including objects stored in directory buckets, you must use AdvancedEventSelectors. You must also use AdvancedEventSelectors if you want to filter on the eventName field. Configure the DataResource to specify the resource type and resource ARNs for which you want to log data events. The following example demonstrates how logging works when you configure logging of all data events for a general purpose bucket named amzn-s3-demo-bucket1. In this example, the CloudTrail user specified an empty prefix, and the option to log both Read and Write data events. A user uploads an image file to amzn-s3-demo-bucket1. The PutObject API operation is an Amazon S3 object-level API. It is recorded as a data event in CloudTrail. Because the CloudTrail user specified an S3 bucket with an empty prefix, events that occur on any object in that bucket are logged. The trail processes and logs the event. A user uploads an object to an Amazon S3 bucket named arn:aws:s3:::amzn-s3-demo-bucket1. The PutObject API operation occurred for an object in an S3 bucket that the CloudTrail user didn't specify for the trail. The trail doesn't log the event. The following example demonstrates how logging works when you configure logging of Lambda data events for a Lambda function named MyLambdaFunction, but not for all Lambda functions. A user runs a script that includes a call to the MyLambdaFunction function and the MyOtherLambdaFunction function. The Invoke API operation on MyLambdaFunction is an Lambda API. Because the CloudTrail user specified logging data events for MyLambdaFunction, any invocations of that function are logged. The Invoke API operation on MyOtherLambdaFunction is an Lambda API. Because the CloudTrail user did not specify logging data events for all Lambda functions, the Invoke operation for MyOtherLambdaFunction does not match the function specified for the trail. Type (string) --- The resource type in which you want to log data events. You can specify the following basic event selector resource types: AWS::DynamoDB::Table AWS::Lambda::Function AWS::S3::Object Additional resource types are available through advanced event selectors. For more information, see AdvancedEventSelector. Values (list) --- An array of Amazon Resource Name (ARN) strings or partial ARN strings for the specified resource type. To log data events for all objects in all S3 buckets in your Amazon Web Services account, specify the prefix as arn:aws:s3. To log data events for all objects in an S3 bucket, specify the bucket and an empty object prefix such as arn:aws:s3:::amzn-s3-demo-bucket1/. The trail logs data events for all objects in this S3 bucket. To log data events for specific objects, specify the S3 bucket and object prefix such as arn:aws:s3:::amzn-s3-demo-bucket1/example-images. The trail logs data events for objects in this S3 bucket that match the prefix. To log data events for all Lambda functions in your Amazon Web Services account, specify the prefix as arn:aws:lambda. To log data events for a specific Lambda function, specify the function ARN. To log data events for all DynamoDB tables in your Amazon Web Services account, specify the prefix as arn:aws:dynamodb. (string) --- ExcludeManagementEventSources (list) --- An optional list of service event sources from which you do not want management events to be logged on your trail. In this release, the list can be empty (disables the filter), or it can filter out Key Management Service or Amazon RDS Data API events by containing kms.amazonaws.com or rdsdata.amazonaws.com. By default, ExcludeManagementEventSources is empty, and KMS and Amazon RDS Data API events are logged to your trail. You can exclude management event sources only in Regions that support the event source. (string) ---",
      "nested_params": []
    },
    {
      "name": "AdvancedEventSelectors",
      "type": "list",
      "required": true,
      "description": "Specifies the settings for advanced event selectors. You can use advanced event selectors to log management events, data events for all resource types, and network activity events. You can add advanced event selectors, and conditions for your advanced event selectors, up to a maximum of 500 values for all conditions and selectors on a trail. You can use either AdvancedEventSelectors or EventSelectors, but not both. If you apply AdvancedEventSelectors to a trail, any existing EventSelectors are overwritten. For more information about advanced event selectors, see Logging data events and Logging network activity events in the CloudTrail User Guide. (dict) --- Advanced event selectors let you create fine-grained selectors for CloudTrail management, data, and network activity events. They help you control costs by logging only those events that are important to you. For more information about configuring advanced event selectors, see the Logging data events, Logging network activity events, and Logging management events topics in the CloudTrail User Guide. You cannot apply both event selectors and advanced event selectors to a trail. For information about configurable advanced event selector fields, see AdvancedEventSelector in the CloudTrail API Reference. Name (string) --- An optional, descriptive name for an advanced event selector, such as 'Log data events for only two S3 buckets'. Contains all selector statements in an advanced event selector. (dict) --- A single selector statement in an advanced event selector. A field in a CloudTrail event record on which to filter events to be logged. For event data stores for CloudTrail Insights events, Config configuration items, Audit Manager evidence, or events outside of Amazon Web Services, the field is used only for selecting events as filtering is not supported. For more information, see AdvancedFieldSelector in the CloudTrail API Reference. Equals (list) --- An operator that includes events that match the exact value of the event record field specified as the value of Field. This is the only valid operator that you can use with the readOnly, eventCategory, and resources.type fields. (string) --- StartsWith (list) --- An operator that includes events that match the first few characters of the event record field specified as the value of Field. (string) --- EndsWith (list) --- An operator that includes events that match the last few characters of the event record field specified as the value of Field. (string) --- NotEquals (list) --- An operator that excludes events that match the exact value of the event record field specified as the value of Field. (string) --- NotStartsWith (list) --- An operator that excludes events that match the first few characters of the event record field specified as the value of Field. (string) --- NotEndsWith (list) --- An operator that excludes events that match the last few characters of the event record field specified as the value of Field. (string) ---",
      "nested_params": [
        {
          "name": "Name",
          "type": "string",
          "required": false,
          "description": "An optional, descriptive name for an advanced event selector, such as 'Log data events for only two S3 buckets'.",
          "nested_params": []
        },
        {
          "name": "FieldSelectors",
          "type": "list",
          "required": false,
          "description": "Contains all selector statements in an advanced event selector.",
          "nested_params": [
            {
              "name": "Field",
              "type": "string",
              "required": false,
              "description": "A field in a CloudTrail event record on which to filter events to be logged. For event data stores for CloudTrail Insights events, Config configuration items, Audit Manager evidence, or events outside of Amazon Web Services, the field is used only for selecting events as filtering is not supported. For more information, see AdvancedFieldSelector in the CloudTrail API Reference.",
              "nested_params": []
            },
            {
              "name": "Equals",
              "type": "list",
              "required": false,
              "description": "An operator that includes events that match the exact value of the event record field specified as the value of Field. This is the only valid operator that you can use with the readOnly, eventCategory, and resources.type fields.",
              "nested_params": []
            },
            {
              "name": "StartsWith",
              "type": "list",
              "required": false,
              "description": "An operator that includes events that match the first few characters of the event record field specified as the value of Field.",
              "nested_params": []
            },
            {
              "name": "EndsWith",
              "type": "list",
              "required": false,
              "description": "An operator that includes events that match the last few characters of the event record field specified as the value of Field.",
              "nested_params": []
            },
            {
              "name": "NotEquals",
              "type": "list",
              "required": false,
              "description": "An operator that excludes events that match the exact value of the event record field specified as the value of Field.",
              "nested_params": []
            },
            {
              "name": "NotStartsWith",
              "type": "list",
              "required": false,
              "description": "An operator that excludes events that match the first few characters of the event record field specified as the value of Field.",
              "nested_params": []
            },
            {
              "name": "NotEndsWith",
              "type": "list",
              "required": false,
              "description": "An operator that excludes events that match the last few characters of the event record field specified as the value of Field.",
              "nested_params": []
            }
          ]
        }
      ]
    }
  ],
  "return_structure": [
    {
      "name": "",
      "type": "dict",
      "description": "",
      "nested_items": [
        {
          "name": "TrailARN",
          "type": "string",
          "description": "Specifies the ARN of the trail that was updated with event selectors. The following is the format of a trail ARN.",
          "nested_items": []
        },
        {
          "name": "EventSelectors",
          "type": "list",
          "description": "Specifies the event selectors configured for your trail.",
          "nested_items": [
            {
              "name": "",
              "type": "dict",
              "description": "",
              "nested_items": [
                {
                  "name": "ReadWriteType",
                  "type": "string",
                  "description": "Specify if you want your trail to log read-only events, write-only events, or all. For example, the EC2 GetConsoleOutput is a read-only API operation and RunInstances is a write-only API operation.",
                  "nested_items": []
                },
                {
                  "name": "IncludeManagementEvents",
                  "type": "boolean",
                  "description": "Specify if you want your event selector to include management events for your trail.",
                  "nested_items": []
                },
                {
                  "name": "DataResources",
                  "type": "list",
                  "description": "CloudTrail supports data event logging for Amazon S3 objects in standard S3 buckets, Lambda functions, and Amazon DynamoDB tables with basic event selectors. You can specify up to 250 resources for an individual event selector, but the total number of data resources cannot exceed 250 across all event selectors in a trail. This limit does not apply if you configure resource logging for all data events.",
                  "nested_items": [
                    {
                      "name": "",
                      "type": "dict",
                      "description": "",
                      "nested_items": [
                        {
                          "name": "",
                          "type": "",
                          "description": "AWS::DynamoDB::Table.",
                          "nested_items": []
                        },
                        {
                          "name": "",
                          "type": "",
                          "description": "AWS::Lambda::Function.",
                          "nested_items": []
                        },
                        {
                          "name": "",
                          "type": "",
                          "description": "AWS::S3::Object.",
                          "nested_items": []
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "ExcludeManagementEventSources",
                  "type": "list",
                  "description": "An optional list of service event sources from which you do not want management events to be logged on your trail. In this release, the list can be empty (disables the filter), or it can filter out Key Management Service or Amazon RDS Data API events by containing kms.amazonaws.com or rdsdata.amazonaws.com. By default, ExcludeManagementEventSources is empty, and KMS and Amazon RDS Data API events are logged to your trail. You can exclude management event sources only in Regions that support the event source.",
                  "nested_items": [
                    {
                      "name": "",
                      "type": "string",
                      "description": "(string) ---",
                      "nested_items": []
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "AdvancedEventSelectors",
          "type": "list",
          "description": "Specifies the advanced event selectors configured for your trail.",
          "nested_items": [
            {
              "name": "",
              "type": "dict",
              "description": "",
              "nested_items": [
                {
                  "name": "Name",
                  "type": "string",
                  "description": "An optional, descriptive name for an advanced event selector, such as 'Log data events for only two S3 buckets'.",
                  "nested_items": []
                },
                {
                  "name": "FieldSelectors",
                  "type": "list",
                  "description": "Contains all selector statements in an advanced event selector.",
                  "nested_items": [
                    {
                      "name": "",
                      "type": "dict",
                      "description": "",
                      "nested_items": [
                        {
                          "name": "Field",
                          "type": "string",
                          "description": "A field in a CloudTrail event record on which to filter events to be logged. For event data stores for CloudTrail Insights events, Config configuration items, Audit Manager evidence, or events outside of Amazon Web Services, the field is used only for selecting events as filtering is not supported.",
                          "nested_items": []
                        },
                        {
                          "name": "Equals",
                          "type": "list",
                          "description": "An operator that includes events that match the exact value of the event record field specified as the value of Field. This is the only valid operator that you can use with the readOnly, eventCategory, and resources.type fields.",
                          "nested_items": [
                            {
                              "name": "",
                              "type": "string",
                              "description": "(string) ---",
                              "nested_items": []
                            }
                          ]
                        },
                        {
                          "name": "StartsWith",
                          "type": "list",
                          "description": "An operator that includes events that match the first few characters of the event record field specified as the value of Field.",
                          "nested_items": [
                            {
                              "name": "",
                              "type": "string",
                              "description": "(string) ---",
                              "nested_items": []
                            }
                          ]
                        },
                        {
                          "name": "EndsWith",
                          "type": "list",
                          "description": "An operator that includes events that match the last few characters of the event record field specified as the value of Field.",
                          "nested_items": [
                            {
                              "name": "",
                              "type": "string",
                              "description": "(string) ---",
                              "nested_items": []
                            }
                          ]
                        },
                        {
                          "name": "NotEquals",
                          "type": "list",
                          "description": "An operator that excludes events that match the exact value of the event record field specified as the value of Field.",
                          "nested_items": [
                            {
                              "name": "",
                              "type": "string",
                              "description": "(string) ---",
                              "nested_items": []
                            }
                          ]
                        },
                        {
                          "name": "NotStartsWith",
                          "type": "list",
                          "description": "An operator that excludes events that match the first few characters of the event record field specified as the value of Field.",
                          "nested_items": [
                            {
                              "name": "",
                              "type": "string",
                              "description": "(string) ---",
                              "nested_items": []
                            }
                          ]
                        },
                        {
                          "name": "NotEndsWith",
                          "type": "list",
                          "description": "An operator that excludes events that match the last few characters of the event record field specified as the value of Field.",
                          "nested_items": [
                            {
                              "name": "",
                              "type": "string",
                              "description": "(string) ---",
                              "nested_items": []
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}