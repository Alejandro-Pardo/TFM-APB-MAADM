{
  "method_name": "get_usage_statistics",
  "url": "https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/guardduty/client/get_usage_statistics.html",
  "description": "Lists Amazon GuardDuty usage statistics over the last 30 days for the specified detector ID. For newly enabled detectors or data sources, the cost returned will include only the usage so far under 30 days. This may differ from the cost metrics in the console, which project usage over 30 days to provide a monthly cost estimate. For more information, see Understanding How Usage Costs are Calculated.",
  "parameters": [
    {
      "name": "DetectorId",
      "type": "string",
      "required": true,
      "description": "The ID of the detector that specifies the GuardDuty service whose usage statistics you want to retrieve. To find the detectorId in the current Region, see the Settings page in the GuardDuty console, or run the ListDetectors API.",
      "nested_params": []
    },
    {
      "name": "UsageStatisticType",
      "type": "string",
      "required": true,
      "description": "The type of usage statistics to retrieve.",
      "nested_params": []
    },
    {
      "name": "UsageCriteria",
      "type": "dict",
      "required": true,
      "description": "Represents the criteria used for querying usage. AccountIds (list) --- The account IDs to aggregate usage statistics from. (string) --- DataSources (list) --- The data sources to aggregate usage statistics from. (string) --- Resources (list) --- The resources to aggregate usage statistics from. Only accepts exact resource names. (string) --- Features (list) --- The features to aggregate usage statistics from. (string) ---",
      "nested_params": [
        {
          "name": "AccountIds",
          "type": "list",
          "required": false,
          "description": "The account IDs to aggregate usage statistics from.",
          "nested_params": []
        },
        {
          "name": "DataSources",
          "type": "list",
          "required": false,
          "description": "The data sources to aggregate usage statistics from.",
          "nested_params": []
        },
        {
          "name": "Resources",
          "type": "list",
          "required": false,
          "description": "The resources to aggregate usage statistics from. Only accepts exact resource names.",
          "nested_params": []
        },
        {
          "name": "Features",
          "type": "list",
          "required": false,
          "description": "The features to aggregate usage statistics from.",
          "nested_params": []
        }
      ]
    },
    {
      "name": "Unit",
      "type": "string",
      "required": false,
      "description": "",
      "nested_params": []
    },
    {
      "name": "MaxResults",
      "type": "integer",
      "required": false,
      "description": "",
      "nested_params": []
    },
    {
      "name": "NextToken",
      "type": "string",
      "required": false,
      "description": "",
      "nested_params": []
    }
  ],
  "return_structure": [
    {
      "name": "",
      "type": "dict",
      "description": "",
      "nested_items": [
        {
          "name": "UsageStatistics",
          "type": "dict",
          "description": "The usage statistics object. If a UsageStatisticType was provided, the objects representing other types will be null.",
          "nested_items": [
            {
              "name": "SumByAccount",
              "type": "list",
              "description": "The usage statistic sum organized by account ID.",
              "nested_items": [
                {
                  "name": "",
                  "type": "dict",
                  "description": "",
                  "nested_items": [
                    {
                      "name": "AccountId",
                      "type": "string",
                      "description": "The Account ID that generated usage.",
                      "nested_items": []
                    },
                    {
                      "name": "",
                      "type": "dict",
                      "description": "",
                      "nested_items": [
                        {
                          "name": "Amount",
                          "type": "string",
                          "description": "The total usage.",
                          "nested_items": []
                        },
                        {
                          "name": "Unit",
                          "type": "string",
                          "description": "The currency unit that the amount is given in.",
                          "nested_items": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "TopAccountsByFeature",
              "type": "list",
              "description": "Lists the top 50 accounts by feature that have generated the most GuardDuty usage, in the order from most to least expensive.",
              "nested_items": [
                {
                  "name": "",
                  "type": "dict",
                  "description": "",
                  "nested_items": [
                    {
                      "name": "Feature",
                      "type": "string",
                      "description": "Features by which you can generate the usage statistics.",
                      "nested_items": []
                    },
                    {
                      "name": "Accounts",
                      "type": "list",
                      "description": "The accounts that contributed to the total usage cost.",
                      "nested_items": [
                        {
                          "name": "",
                          "type": "dict",
                          "description": "",
                          "nested_items": [
                            {
                              "name": "AccountId",
                              "type": "string",
                              "description": "The unique account ID.",
                              "nested_items": []
                            },
                            {
                              "name": "",
                              "type": "dict",
                              "description": "",
                              "nested_items": [
                                {
                                  "name": "Amount",
                                  "type": "string",
                                  "description": "The total usage.",
                                  "nested_items": []
                                },
                                {
                                  "name": "Unit",
                                  "type": "string",
                                  "description": "The currency unit that the amount is given in.",
                                  "nested_items": []
                                }
                              ]
                            }
                          ]
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "SumByDataSource",
              "type": "list",
              "description": "The usage statistic sum organized by on data source.",
              "nested_items": [
                {
                  "name": "",
                  "type": "dict",
                  "description": "",
                  "nested_items": [
                    {
                      "name": "DataSource",
                      "type": "string",
                      "description": "The data source type that generated usage.",
                      "nested_items": []
                    },
                    {
                      "name": "",
                      "type": "dict",
                      "description": "",
                      "nested_items": [
                        {
                          "name": "Amount",
                          "type": "string",
                          "description": "The total usage.",
                          "nested_items": []
                        },
                        {
                          "name": "Unit",
                          "type": "string",
                          "description": "The currency unit that the amount is given in.",
                          "nested_items": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "SumByResource",
              "type": "list",
              "description": "The usage statistic sum organized by resource.",
              "nested_items": [
                {
                  "name": "",
                  "type": "dict",
                  "description": "",
                  "nested_items": [
                    {
                      "name": "Resource",
                      "type": "string",
                      "description": "The Amazon Web Services resource that generated usage.",
                      "nested_items": []
                    },
                    {
                      "name": "",
                      "type": "dict",
                      "description": "",
                      "nested_items": [
                        {
                          "name": "Amount",
                          "type": "string",
                          "description": "The total usage.",
                          "nested_items": []
                        },
                        {
                          "name": "Unit",
                          "type": "string",
                          "description": "The currency unit that the amount is given in.",
                          "nested_items": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "TopResources",
              "type": "list",
              "description": "Lists the top 50 resources that have generated the most GuardDuty usage, in order from most to least expensive.",
              "nested_items": [
                {
                  "name": "",
                  "type": "dict",
                  "description": "",
                  "nested_items": [
                    {
                      "name": "Resource",
                      "type": "string",
                      "description": "The Amazon Web Services resource that generated usage.",
                      "nested_items": []
                    },
                    {
                      "name": "",
                      "type": "dict",
                      "description": "",
                      "nested_items": [
                        {
                          "name": "Amount",
                          "type": "string",
                          "description": "The total usage.",
                          "nested_items": []
                        },
                        {
                          "name": "Unit",
                          "type": "string",
                          "description": "The currency unit that the amount is given in.",
                          "nested_items": []
                        }
                      ]
                    }
                  ]
                }
              ]
            },
            {
              "name": "SumByFeature",
              "type": "list",
              "description": "The usage statistic sum organized by feature.",
              "nested_items": [
                {
                  "name": "",
                  "type": "dict",
                  "description": "",
                  "nested_items": [
                    {
                      "name": "Feature",
                      "type": "string",
                      "description": "The feature that generated the usage cost.",
                      "nested_items": []
                    },
                    {
                      "name": "",
                      "type": "dict",
                      "description": "",
                      "nested_items": [
                        {
                          "name": "Amount",
                          "type": "string",
                          "description": "The total usage.",
                          "nested_items": []
                        },
                        {
                          "name": "Unit",
                          "type": "string",
                          "description": "The currency unit that the amount is given in.",
                          "nested_items": []
                        }
                      ]
                    }
                  ]
                }
              ]
            }
          ]
        },
        {
          "name": "NextToken",
          "type": "string",
          "description": "The pagination parameter to be used on the next list operation to retrieve more items.",
          "nested_items": []
        }
      ]
    }
  ]
}