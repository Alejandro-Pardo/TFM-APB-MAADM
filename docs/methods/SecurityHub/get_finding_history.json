{
  "method_name": "get_finding_history",
  "url": "https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/securityhub/client/get_finding_history.html",
  "description": "Returns the history of a Security Hub finding for the past 90 days. The history includes changes made to any fields in the Amazon Web Services Security Finding Format (ASFF) except top-level timestamp fields, such as the CreatedAt and UpdatedAt fields. This operation might return fewer results than the maximum number of results ( MaxResults) specified in a request, even when more results are available. If this occurs, the response includes a NextToken value, which you should use to retrieve the next set of results in the response. The presence of a NextToken value in a response doesn't necessarily indicate that the results are incomplete. However, you should continue to specify a NextToken value until you receive a response that doesn't include this value.",
  "parameters": [
    {
      "name": "FindingIdentifier",
      "type": "dict",
      "required": true,
      "description": "Identifies which finding to get the finding history for. The identifier of the finding that was specified by the finding provider. The ARN generated by Security Hub that uniquely identifies a product that generates findings. This can be the ARN for a third-party product that is integrated with Security Hub, or the ARN for a custom integration.",
      "nested_params": [
        {
          "name": "Id",
          "type": "string",
          "required": false,
          "description": "The identifier of the finding that was specified by the finding provider.",
          "nested_params": []
        },
        {
          "name": "ProductArn",
          "type": "string",
          "required": false,
          "description": "The ARN generated by Security Hub that uniquely identifies a product that generates findings. This can be the ARN for a third-party product that is integrated with Security Hub, or the ARN for a custom integration.",
          "nested_params": []
        }
      ]
    },
    {
      "name": "StartTime",
      "type": "datetime",
      "required": false,
      "description": "A timestamp that indicates the start time of the requested finding history. If you provide values for both StartTime and EndTime, Security Hub returns finding history for the specified time period. If you provide a value for StartTime but not for EndTime, Security Hub returns finding history from the StartTime to the time at which the API is called. If you provide a value for EndTime but not for StartTime, Security Hub returns finding history from the CreatedAt timestamp of the finding to the EndTime. If you provide neither StartTime nor EndTime, Security Hub returns finding history from the CreatedAt timestamp of the finding to the time at which the API is called. In all of these scenarios, the response is limited to 100 results, and the maximum time period is limited to 90 days. For more information about the validation and formatting of timestamp fields in Security Hub, see Timestamps.",
      "nested_params": []
    },
    {
      "name": "EndTime",
      "type": "datetime",
      "required": false,
      "description": "An ISO 8601-formatted timestamp that indicates the end time of the requested finding history. If you provide values for both StartTime and EndTime, Security Hub returns finding history for the specified time period. If you provide a value for StartTime but not for EndTime, Security Hub returns finding history from the StartTime to the time at which the API is called. If you provide a value for EndTime but not for StartTime, Security Hub returns finding history from the CreatedAt timestamp of the finding to the EndTime. If you provide neither StartTime nor EndTime, Security Hub returns finding history from the CreatedAt timestamp of the finding to the time at which the API is called. In all of these scenarios, the response is limited to 100 results, and the maximum time period is limited to 90 days. For more information about the validation and formatting of timestamp fields in Security Hub, see Timestamps.",
      "nested_params": []
    },
    {
      "name": "NextToken",
      "type": "string",
      "required": false,
      "description": "",
      "nested_params": []
    },
    {
      "name": "MaxResults",
      "type": "integer",
      "required": false,
      "description": "",
      "nested_params": []
    }
  ],
  "return_structure": [
    {
      "name": "",
      "type": "dict",
      "description": "",
      "nested_items": [
        {
          "name": "Records",
          "type": "list",
          "description": "A list of events that altered the specified finding during the specified time period.",
          "nested_items": [
            {
              "name": "",
              "type": "dict",
              "description": "",
              "nested_items": [
                {
                  "name": "FindingIdentifier",
                  "type": "dict",
                  "description": "Identifies which finding to get the finding history for.",
                  "nested_items": [
                    {
                      "name": "Id",
                      "type": "string",
                      "description": "The identifier of the finding that was specified by the finding provider.",
                      "nested_items": []
                    },
                    {
                      "name": "ProductArn",
                      "type": "string",
                      "description": "The ARN generated by Security Hub that uniquely identifies a product that generates findings. This can be the ARN for a third-party product that is integrated with Security Hub, or the ARN for a custom integration.",
                      "nested_items": []
                    }
                  ]
                },
                {
                  "name": "UpdateTime",
                  "type": "datetime",
                  "description": "A timestamp that indicates when Security Hub processed the updated finding record.",
                  "nested_items": []
                },
                {
                  "name": "FindingCreated",
                  "type": "boolean",
                  "description": "Identifies whether the event marks the creation of a new finding. A value of True means that the finding is newly created. A value of False means that the finding isn't newly created.",
                  "nested_items": []
                },
                {
                  "name": "UpdateSource",
                  "type": "dict",
                  "description": "Identifies the source of the event that changed the finding. For example, an integrated Amazon Web Services service or third-party partner integration may call BatchImportFindings, or an Security Hub customer may call BatchUpdateFindings.",
                  "nested_items": [
                    {
                      "name": "Type",
                      "type": "string",
                      "description": "Describes the type of finding change event, such as a call to BatchImportFindings (by an integrated Amazon Web Services service or third party partner integration) or BatchUpdateFindings (by a Security Hub customer).",
                      "nested_items": []
                    },
                    {
                      "name": "Identity",
                      "type": "string",
                      "description": "The identity of the source that initiated the finding change event. For example, the Amazon Resource Name (ARN) of a partner that calls BatchImportFindings or of a customer that calls BatchUpdateFindings.",
                      "nested_items": []
                    }
                  ]
                },
                {
                  "name": "Updates",
                  "type": "list",
                  "description": "An array of objects that provides details about the finding change event, including the Amazon Web Services Security Finding Format (ASFF) field that changed, the value of the field before the change, and the value of the field after the change.",
                  "nested_items": [
                    {
                      "name": "",
                      "type": "dict",
                      "description": "",
                      "nested_items": [
                        {
                          "name": "UpdatedField",
                          "type": "string",
                          "description": "The ASFF field that changed during the finding change event.",
                          "nested_items": []
                        },
                        {
                          "name": "OldValue",
                          "type": "string",
                          "description": "The value of the ASFF field before the finding change event.",
                          "nested_items": []
                        },
                        {
                          "name": "NewValue",
                          "type": "string",
                          "description": "The value of the ASFF field after the finding change event. To preserve storage and readability, Security Hub omits this value if FindingHistoryRecord exceeds database limits.",
                          "nested_items": []
                        }
                      ]
                    }
                  ]
                },
                {
                  "name": "NextToken",
                  "type": "string",
                  "description": "A token for pagination purposes. Provide this token in the subsequent request to GetFindingsHistory to get up to an additional 100 results of history for the same finding that you specified in your initial request.",
                  "nested_items": []
                }
              ]
            }
          ]
        },
        {
          "name": "NextToken",
          "type": "string",
          "description": "A token for pagination purposes. Provide this token in the subsequent request to GetFindingsHistory to get up to an additional 100 results of history for the same finding that you specified in your initial request.",
          "nested_items": []
        }
      ]
    }
  ]
}