{
  "method_name": "update_control",
  "url": "https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/auditmanager/client/update_control.html",
  "description": "Updates a custom control in Audit Manager.",
  "parameters": [
    {
      "name": "controlId",
      "type": "string",
      "required": true,
      "description": "The identifier for the control.",
      "nested_params": []
    },
    {
      "name": "name",
      "type": "string",
      "required": true,
      "description": "The name of the updated control.",
      "nested_params": []
    },
    {
      "name": "description",
      "type": "string",
      "required": false,
      "description": "",
      "nested_params": []
    },
    {
      "name": "testingInformation",
      "type": "string",
      "required": false,
      "description": "",
      "nested_params": []
    },
    {
      "name": "actionPlanTitle",
      "type": "string",
      "required": false,
      "description": "",
      "nested_params": []
    },
    {
      "name": "actionPlanInstructions",
      "type": "string",
      "required": false,
      "description": "",
      "nested_params": []
    },
    {
      "name": "controlMappingSources",
      "type": "list",
      "required": true,
      "description": "The data mapping sources for the control. (dict) --- The data source that determines where Audit Manager collects evidence from for the control. sourceId (string) --- The unique identifier for the source. sourceName (string) --- The name of the source. sourceDescription (string) --- The description of the source. sourceSetUpOption (string) --- The setup option for the data source. This option reflects if the evidence collection method is automated or manual. If you don't provide a value for sourceSetUpOption, Audit Manager automatically infers and populates the correct value based on the sourceType that you specify. sourceType (string) --- Specifies which type of data source is used to collect evidence. The source can be an individual data source type, such as AWS_Cloudtrail, AWS_Config, AWS_Security_Hub, AWS_API_Call, or MANUAL. The source can also be a managed grouping of data sources, such as a Core_Control or a Common_Control. sourceKeyword (dict) --- A keyword that relates to the control data source. For manual evidence, this keyword indicates if the manual evidence is a file or text. For automated evidence, this keyword identifies a specific CloudTrail event, Config rule, Security Hub control, or Amazon Web Services API name. To learn more about the supported keywords that you can use when mapping a control data source, see the following pages in the Audit Manager User Guide: Config rules supported by Audit Manager Security Hub controls supported by Audit Manager API calls supported by Audit Manager CloudTrail event names supported by Audit Manager keywordInputType (string) --- The input method for the keyword. SELECT_FROM_LIST is used when mapping a data source for automated evidence. When keywordInputType is SELECT_FROM_LIST, a keyword must be selected to collect automated evidence. For example, this keyword can be a CloudTrail event name, a rule name for Config, a Security Hub control, or the name of an Amazon Web Services API call. UPLOAD_FILE and INPUT_TEXT are only used when mapping a data source for manual evidence. When keywordInputType is UPLOAD_FILE, a file must be uploaded as manual evidence. When keywordInputType is INPUT_TEXT, text must be entered as manual evidence. keywordValue (string) --- The value of the keyword that's used when mapping a control data source. For example, this can be a CloudTrail event name, a rule name for Config, a Security Hub control, or the name of an Amazon Web Services API call. If you're mapping a data source to a rule in Config, the keywordValue that you specify depends on the type of rule: For managed rules, you can use the rule identifier as the keywordValue. You can find the rule identifier from the list of Config managed rules. For some rules, the rule identifier is different from the rule name. For example, the rule name restricted-ssh has the following rule identifier: INCOMING_SSH_DISABLED. Make sure to use the rule identifier, not the rule name. Keyword example for managed rules: Managed rule name: s3-bucket-acl-prohibited keywordValue: S3_BUCKET_ACL_PROHIBITED For custom rules, you form the keywordValue by adding the Custom_ prefix to the rule name. This prefix distinguishes the custom rule from a managed rule. Keyword example for custom rules: Custom rule name: my-custom-config-rule keywordValue: Custom_my-custom-config-rule For service-linked rules, you form the keywordValue by adding the Custom_ prefix to the rule name. In addition, you remove the suffix ID that appears at the end of the rule name. Keyword examples for service-linked rules: Service-linked rule name: CustomRuleForAccount-conformance-pack-szsm1uv0w keywordValue: Custom_CustomRuleForAccount-conformance-pack Service-linked rule name: OrgConfigRule-s3-bucket-versioning-enabled-dbgzf8ba keywordValue: Custom_OrgConfigRule-s3-bucket-versioning-enabled sourceFrequency (string) --- Specifies how often evidence is collected from the control mapping source. troubleshootingText (string) --- The instructions for troubleshooting the control.",
      "nested_params": [
        {
          "name": "sourceId",
          "type": "string",
          "required": false,
          "description": "The unique identifier for the source.",
          "nested_params": []
        },
        {
          "name": "sourceName",
          "type": "string",
          "required": false,
          "description": "The name of the source.",
          "nested_params": []
        },
        {
          "name": "sourceDescription",
          "type": "string",
          "required": false,
          "description": "The description of the source.",
          "nested_params": []
        },
        {
          "name": "sourceSetUpOption",
          "type": "string",
          "required": false,
          "description": "The setup option for the data source. This option reflects if the evidence collection method is automated or manual. If you don't provide a value for sourceSetUpOption, Audit Manager automatically infers and populates the correct value based on the sourceType that you specify.",
          "nested_params": []
        },
        {
          "name": "sourceType",
          "type": "string",
          "required": false,
          "description": "Specifies which type of data source is used to collect evidence.",
          "nested_params": []
        },
        {
          "name": "sourceKeyword",
          "type": "dict",
          "required": false,
          "description": "A keyword that relates to the control data source. For manual evidence, this keyword indicates if the manual evidence is a file or text. For automated evidence, this keyword identifies a specific CloudTrail event, Config rule, Security Hub control, or Amazon Web Services API name. To learn more about the supported keywords that you can use when mapping a control data source, see the following pages in the Audit Manager User Guide:",
          "nested_params": []
        },
        {
          "name": "sourceFrequency",
          "type": "string",
          "required": false,
          "description": "Specifies how often evidence is collected from the control mapping source.",
          "nested_params": []
        },
        {
          "name": "troubleshootingText",
          "type": "string",
          "required": false,
          "description": "The instructions for troubleshooting the control.",
          "nested_params": []
        }
      ]
    }
  ],
  "return_structure": [
    {
      "name": "",
      "type": "dict",
      "description": "",
      "nested_items": [
        {
          "name": "",
          "type": "dict",
          "description": "",
          "nested_items": [
            {
              "name": "arn",
              "type": "string",
              "description": "The Amazon Resource Name (ARN) of the control.",
              "nested_items": []
            },
            {
              "name": "id",
              "type": "string",
              "description": "The unique identifier for the control.",
              "nested_items": []
            },
            {
              "name": "type",
              "type": "string",
              "description": "Specifies whether the control is a standard control or a custom control.",
              "nested_items": []
            },
            {
              "name": "name",
              "type": "string",
              "description": "The name of the control.",
              "nested_items": []
            },
            {
              "name": "description",
              "type": "string",
              "description": "The description of the control.",
              "nested_items": []
            },
            {
              "name": "testingInformation",
              "type": "string",
              "description": "The steps that you should follow to determine if the control has been satisfied.",
              "nested_items": []
            },
            {
              "name": "actionPlanTitle",
              "type": "string",
              "description": "The title of the action plan for remediating the control.",
              "nested_items": []
            },
            {
              "name": "actionPlanInstructions",
              "type": "string",
              "description": "The recommended actions to carry out if the control isn't fulfilled.",
              "nested_items": []
            },
            {
              "name": "controlSources",
              "type": "string",
              "description": "The data source types that determine where Audit Manager collects evidence from for the control.",
              "nested_items": []
            },
            {
              "name": "controlMappingSources",
              "type": "list",
              "description": "The data mapping sources for the control.",
              "nested_items": [
                {
                  "name": "",
                  "type": "dict",
                  "description": "",
                  "nested_items": [
                    {
                      "name": "sourceId",
                      "type": "string",
                      "description": "The unique identifier for the source.",
                      "nested_items": []
                    },
                    {
                      "name": "sourceName",
                      "type": "string",
                      "description": "The name of the source.",
                      "nested_items": []
                    },
                    {
                      "name": "sourceDescription",
                      "type": "string",
                      "description": "The description of the source.",
                      "nested_items": []
                    },
                    {
                      "name": "sourceSetUpOption",
                      "type": "string",
                      "description": "The setup option for the data source. This option reflects if the evidence collection method is automated or manual. If you don't provide a value for sourceSetUpOption, Audit Manager automatically infers and populates the correct value based on the sourceType that you specify.",
                      "nested_items": []
                    },
                    {
                      "name": "sourceType",
                      "type": "string",
                      "description": "Specifies which type of data source is used to collect evidence.",
                      "nested_items": [
                        {
                          "name": "",
                          "type": "",
                          "description": "The source can be an individual data source type, such as AWS_Cloudtrail, AWS_Config, AWS_Security_Hub, AWS_API_Call, or MANUAL.",
                          "nested_items": []
                        },
                        {
                          "name": "",
                          "type": "",
                          "description": "The source can also be a managed grouping of data sources, such as a Core_Control or a Common_Control.",
                          "nested_items": []
                        }
                      ]
                    },
                    {
                      "name": "sourceKeyword",
                      "type": "dict",
                      "description": "A keyword that relates to the control data source.",
                      "nested_items": [
                        {
                          "name": "",
                          "type": "",
                          "description": "Config rules supported by Audit Manager.",
                          "nested_items": []
                        },
                        {
                          "name": "",
                          "type": "",
                          "description": "Security Hub controls supported by Audit Manager.",
                          "nested_items": []
                        },
                        {
                          "name": "",
                          "type": "",
                          "description": "API calls supported by Audit Manager.",
                          "nested_items": []
                        },
                        {
                          "name": "",
                          "type": "",
                          "description": "CloudTrail event names supported by Audit Manager.",
                          "nested_items": []
                        }
                      ]
                    },
                    {
                      "name": "sourceFrequency",
                      "type": "string",
                      "description": "Specifies how often evidence is collected from the control mapping source.",
                      "nested_items": []
                    },
                    {
                      "name": "troubleshootingText",
                      "type": "string",
                      "description": "The instructions for troubleshooting the control.",
                      "nested_items": []
                    }
                  ]
                }
              ]
            },
            {
              "name": "createdAt",
              "type": "datetime",
              "description": "The time when the control was created.",
              "nested_items": []
            },
            {
              "name": "lastUpdatedAt",
              "type": "datetime",
              "description": "The time when the control was most recently updated.",
              "nested_items": []
            },
            {
              "name": "createdBy",
              "type": "string",
              "description": "The user or role that created the control.",
              "nested_items": []
            },
            {
              "name": "lastUpdatedBy",
              "type": "string",
              "description": "The user or role that most recently updated the control.",
              "nested_items": []
            },
            {
              "name": "",
              "type": "dict",
              "description": "",
              "nested_items": [
                {
                  "name": "",
                  "type": "string",
                  "description": "(string) ---",
                  "nested_items": [
                    {
                      "name": "",
                      "type": "string",
                      "description": "(string) ---",
                      "nested_items": []
                    }
                  ]
                }
              ]
            },
            {
              "name": "state",
              "type": "string",
              "description": "The state of the control. The END_OF_SUPPORT state is applicable to standard controls only. This state indicates that the standard control can still be used to collect evidence, but Audit Manager is no longer updating or maintaining that control.",
              "nested_items": []
            }
          ]
        }
      ]
    }
  ]
}