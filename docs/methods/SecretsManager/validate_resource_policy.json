{
  "method_name": "validate_resource_policy",
  "url": "https://boto3.amazonaws.com/v1/documentation/api/latest/reference/services/secretsmanager/client/validate_resource_policy.html",
  "description": "Validates that a resource policy does not grant a wide range of principals access to your secret. A resource-based policy is optional for secrets. The API performs three checks when validating the policy: Secrets Manager generates a CloudTrail log entry when you call this action. Do not include sensitive information in request parameters because it might be logged. For more information, see Logging Secrets Manager events with CloudTrail. Required permissions: secretsmanager:ValidateResourcePolicy and secretsmanager:PutResourcePolicy. For more information, see IAM policy actions for Secrets Manager and Authentication and access control in Secrets Manager.",
  "parameters": [
    {
      "name": "SecretId",
      "type": "string",
      "required": false,
      "description": "",
      "nested_params": []
    },
    {
      "name": "ResourcePolicy",
      "type": "string",
      "required": true,
      "description": "A JSON-formatted string that contains an Amazon Web Services resource-based policy. The policy in the string identifies who can access or manage this secret and its versions. For example policies, see Permissions policy examples.",
      "nested_params": []
    }
  ],
  "return_structure": [
    {
      "name": "",
      "type": "dict",
      "description": "",
      "nested_items": [
        {
          "name": "PolicyValidationPassed",
          "type": "boolean",
          "description": "True if your policy passes validation, otherwise false.",
          "nested_items": []
        },
        {
          "name": "ValidationErrors",
          "type": "list",
          "description": "Validation errors if your policy didn't pass validation.",
          "nested_items": [
            {
              "name": "",
              "type": "dict",
              "description": "",
              "nested_items": [
                {
                  "name": "CheckName",
                  "type": "string",
                  "description": "Checks the name of the policy.",
                  "nested_items": []
                },
                {
                  "name": "ErrorMessage",
                  "type": "string",
                  "description": "Displays error messages if validation encounters problems during validation of the resource policy.",
                  "nested_items": []
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}